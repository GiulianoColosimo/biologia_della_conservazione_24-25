<!DOCTYPE html>
<html lang="en"><head>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-html/tabby.min.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/light-border.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles"><meta charset="utf-8">
  <meta name="generator" content="quarto-1.6.39">

  <meta name="dcterms.date" content="2025-01-20">
  <title>Biologia della Conservazione 24/25 – Biologia della conservazione</title>
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reset.css">
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/reveal.css">
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    div.columns{display: flex; gap: min(4vw, 1.5em);}
    div.column{flex: auto; overflow-x: auto;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    ul.task-list li input[type="checkbox"] {
      width: 0.8em;
      margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
      vertical-align: middle;
    }
    /* CSS for syntax highlighting */
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      { color: #003b4f; background-color: #f1f3f5; }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span { color: #003b4f; } /* Normal */
    code span.al { color: #ad0000; } /* Alert */
    code span.an { color: #5e5e5e; } /* Annotation */
    code span.at { color: #657422; } /* Attribute */
    code span.bn { color: #ad0000; } /* BaseN */
    code span.bu { } /* BuiltIn */
    code span.cf { color: #003b4f; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #20794d; } /* Char */
    code span.cn { color: #8f5902; } /* Constant */
    code span.co { color: #5e5e5e; } /* Comment */
    code span.cv { color: #5e5e5e; font-style: italic; } /* CommentVar */
    code span.do { color: #5e5e5e; font-style: italic; } /* Documentation */
    code span.dt { color: #ad0000; } /* DataType */
    code span.dv { color: #ad0000; } /* DecVal */
    code span.er { color: #ad0000; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #ad0000; } /* Float */
    code span.fu { color: #4758ab; } /* Function */
    code span.im { color: #00769e; } /* Import */
    code span.in { color: #5e5e5e; } /* Information */
    code span.kw { color: #003b4f; font-weight: bold; } /* Keyword */
    code span.op { color: #5e5e5e; } /* Operator */
    code span.ot { color: #003b4f; } /* Other */
    code span.pp { color: #ad0000; } /* Preprocessor */
    code span.sc { color: #5e5e5e; } /* SpecialChar */
    code span.ss { color: #20794d; } /* SpecialString */
    code span.st { color: #20794d; } /* String */
    code span.va { color: #111111; } /* Variable */
    code span.vs { color: #20794d; } /* VerbatimString */
    code span.wa { color: #5e5e5e; font-style: italic; } /* Warning */
    /* CSS for citations */
    div.csl-bib-body { }
    div.csl-entry {
      clear: both;
      margin-bottom: 0em;
    }
    .hanging-indent div.csl-entry {
      margin-left:2em;
      text-indent:-2em;
    }
    div.csl-left-margin {
      min-width:2em;
      float:left;
    }
    div.csl-right-inline {
      margin-left:2em;
      padding-left:1em;
    }
    div.csl-indent {
      margin-left: 2em;
    }  </style>
  <link rel="stylesheet" href="../../site_libs/revealjs/dist/theme/quarto-fbff88913fe25870c86f77c0ed158baa.css">
  <link href="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/font-awesome/css/all.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/reveal-chalkboard/style.css" rel="stylesheet">
  <link href="../../site_libs/revealjs/plugin/quarto-support/footer.css" rel="stylesheet">
  <style type="text/css">
    .reveal div.sourceCode {
      margin: 0;
      overflow: auto;
    }
    .reveal div.hanging-indent {
      margin-left: 1em;
      text-indent: -1em;
    }
    .reveal .slide:not(.center) {
      height: 100%;
    }
    .reveal .slide.scrollable {
      overflow-y: auto;
    }
    .reveal .footnotes {
      height: 100%;
      overflow-y: auto;
    }
    .reveal .slide .absolute {
      position: absolute;
      display: block;
    }
    .reveal .footnotes ol {
      counter-reset: ol;
      list-style-type: none; 
      margin-left: 0;
    }
    .reveal .footnotes ol li:before {
      counter-increment: ol;
      content: counter(ol) ". "; 
    }
    .reveal .footnotes ol li > p:first-child {
      display: inline-block;
    }
    .reveal .slide ul,
    .reveal .slide ol {
      margin-bottom: 0.5em;
    }
    .reveal .slide ul li,
    .reveal .slide ol li {
      margin-top: 0.4em;
      margin-bottom: 0.2em;
    }
    .reveal .slide ul[role="tablist"] li {
      margin-bottom: 0;
    }
    .reveal .slide ul li > *:first-child,
    .reveal .slide ol li > *:first-child {
      margin-block-start: 0;
    }
    .reveal .slide ul li > *:last-child,
    .reveal .slide ol li > *:last-child {
      margin-block-end: 0;
    }
    .reveal .slide .columns:nth-child(3) {
      margin-block-start: 0.8em;
    }
    .reveal blockquote {
      box-shadow: none;
    }
    .reveal .tippy-content>* {
      margin-top: 0.2em;
      margin-bottom: 0.7em;
    }
    .reveal .tippy-content>*:last-child {
      margin-bottom: 0.2em;
    }
    .reveal .slide > img.stretch.quarto-figure-center,
    .reveal .slide > img.r-stretch.quarto-figure-center {
      display: block;
      margin-left: auto;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-left,
    .reveal .slide > img.r-stretch.quarto-figure-left  {
      display: block;
      margin-left: 0;
      margin-right: auto; 
    }
    .reveal .slide > img.stretch.quarto-figure-right,
    .reveal .slide > img.r-stretch.quarto-figure-right  {
      display: block;
      margin-left: auto;
      margin-right: 0; 
    }
  </style>
<meta property="og:title" content="Biologia della conservazione – Biologia della Conservazione 24/25">
<meta property="og:description" content="Class 15 - Exercise in R">
<meta property="og:site_name" content="Biologia della Conservazione 24/25">
<meta property="og:locale" content="en_US">
</head>
<body class="quarto-light">
  <div class="reveal">
    <div class="slides">

<section id="title-slide" class="quarto-title-block center">
  <h1 class="title">Biologia della conservazione</h1>
  <p class="subtitle">Class 15 - Exercise in R</p>

<div class="quarto-title-authors">
</div>

  <p class="date">2025-01-20</p>
</section>
<section id="introduction" class="slide level2">
<h2>Introduction</h2>
<ul>
<li><p>In this exercise we will first briefly look at the very basic of R and RStudio. We will then try to use some functions from various R packages to compute some of the genetic indexes that we have discussed in the first part of the course</p></li>
<li><p>We will be using a dataset published by <span class="citation" data-cites="Groombridge2000">Groombridge, Jones, Bruford, &amp; Nichols (<a href="#/references" role="doc-biblioref" onclick="">2000</a>)</span></p></li>
<li><p>The dataset contains 153 individuals of Kestrel, a small bird of prey, typed at 12 microsatellite loci</p></li>
<li><p>The dataset is available <a href="https://drive.proton.me/urls/ZPC7B4HK8M#8xaiV03eLgU2">here</a> as an excel file. Download it and place in a directory of your convenience</p></li>
<li><p>Before moving forward with the excercise I will review some basic <strong>R</strong> stuff, including the installation process and how to retrieve some of the most important packages</p></li>
</ul>
</section>
<section id="setting-up-your-computers" class="slide level2">
<h2>Setting up your computers</h2>
<ul>
<li><p>Connect to Wi-Fi</p></li>
<li><p>Visit the <strong>R</strong> <a href="https://cran.r-project.org" class="uri">https://cran.r-project.org</a> page and download the <strong>R</strong> version compatible with your OS. Install the software following the instructions</p></li>
<li><p>Visit the <strong>RStudio</strong> <a href="https://www.rstudio.com/products/rstudio/download/" class="uri">https://www.rstudio.com/products/rstudio/download/</a> page and download the <strong>RStudio</strong> Desktop version compatible with your OS. Install the software following the instructions. Most recently <strong>RStudio</strong> has changed its name in to <strong>Posit</strong> <a href="https://posit.co" class="uri">https://posit.co</a>, but the core idea is the same!</p></li>
</ul>
<div class="callout callout-important callout-titled callout-style-default">
<div class="callout-body">
<div class="callout-title">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<p><strong>Important</strong></p>
</div>
<div class="callout-content">
<p><strong>RStudio</strong> is an Integrated Development Environment (IDE) within which it should be easier to organize your <strong>R</strong> workflow. <u>Learning all the specifics of <strong>R</strong> and <strong>RStudio</strong> is beyond the scope of this course and it is a student’s responsibility to learn the basics of these tools. That being said, you can always write me with your questions if something does not work on your computer and I will help troubleshooting potential issues.</u></p>
</div>
</div>
</div>
</section>
<section id="brief-intro-to-r-and-rstudio" class="slide level2">
<h2>Brief intro to R and RStudio</h2>
<ul>
<li><p>R is a very powerful programing language. It was conceived for statistical computing, but now it has become a well rounded tool that can be used to do a number of different things, including writing manuscripts and designing websites</p></li>
<li><p>At its core R can still be considered <em>number cruncher</em></p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a></a><span class="co"># basic arithmetic</span></span>
<span id="cb1-2"><a></a><span class="dv">3</span> <span class="sc">+</span> <span class="dv">5</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a></a><span class="co"># assigning values to object</span></span>
<span id="cb3-2"><a></a>a <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb3-3"><a></a>b <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb3-4"><a></a>(c <span class="ot">&lt;-</span> a <span class="sc">+</span> b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 8</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a></a><span class="co"># multiple type of data</span></span>
<span id="cb5-2"><a></a><span class="fu">str</span>(x <span class="ot">&lt;-</span> a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> num 5</code></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a></a><span class="fu">str</span>(y <span class="ot">&lt;-</span> <span class="st">"a"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> chr "a"</code></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a></a><span class="fu">str</span>(z <span class="ot">&lt;-</span> <span class="fu">c</span>(T, F))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code> logi [1:2] TRUE FALSE</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<ul>
<li>Data can be organized in a number of different ways each one with its specific structure</li>
<li>The three most simple “objects” that contain data are vecotrs, matrices, and data frames</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a></a><span class="co"># a matrix</span></span>
<span id="cb11-2"><a></a>(mtrx_ex <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">9</span>, <span class="at">nrow =</span> <span class="dv">3</span>, <span class="at">ncol =</span> <span class="dv">3</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     [,1] [,2] [,3]
[1,]    1    4    7
[2,]    2    5    8
[3,]    3    6    9</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a></a><span class="co"># a data frame</span></span>
<span id="cb13-2"><a></a>(df_ex <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(mtrx_ex))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  V1 V2 V3
1  1  4  7
2  2  5  8
3  3  6  9</code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a></a><span class="co"># another data frame</span></span>
<span id="cb15-2"><a></a>(df_ex <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">id =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>),</span>
<span id="cb15-3"><a></a>                     <span class="at">species =</span> <span class="fu">c</span>(<span class="st">"cat"</span>, <span class="st">"dog"</span>, <span class="st">"lion"</span>),</span>
<span id="cb15-4"><a></a>                     <span class="at">is.domestic =</span> <span class="fu">c</span>(T, T, F)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  id species is.domestic
1  1     cat        TRUE
2  2     dog        TRUE
3  3    lion       FALSE</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<ul>
<li><p>When you first install <strong>R</strong> on your computer you will find only a few basic packages that ship with basic installation</p></li>
<li><p>If you type the following command at your prompt you will get a series of information regarding the version of R and the hardware on which is running</p></li>
<li><p>The command will also output information relative to the name of packages installed and loaded in your working session</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a></a><span class="fu">sessionInfo</span>() <span class="co"># the output is from my computer and mybe different for you</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>R version 4.3.2 (2023-10-31)
Platform: aarch64-apple-darwin20 (64-bit)
Running under: macOS 15.2

Matrix products: default
BLAS:   /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRblas.0.dylib 
LAPACK: /Library/Frameworks/R.framework/Versions/4.3-arm64/Resources/lib/libRlapack.dylib;  LAPACK version 3.11.0

locale:
[1] en_US.UTF-8/en_US.UTF-8/en_US.UTF-8/C/en_US.UTF-8/en_US.UTF-8

time zone: Europe/Rome
tzcode source: internal

attached base packages:
[1] stats     graphics  grDevices utils     datasets  methods   base     

other attached packages:
 [1] hierfstat_0.5-11   readxl_1.4.3       plotly_4.10.4      cranlogs_2.1.1    
 [5] learnPopGen_1.0.4  RColorBrewer_1.1-3 lubridate_1.9.3    forcats_1.0.0     
 [9] stringr_1.5.1      dplyr_1.1.4        purrr_1.0.2        readr_2.1.5       
[13] tidyr_1.3.1        tibble_3.2.1       ggplot2_3.5.1      tidyverse_2.0.0   
[17] DT_0.33           

loaded via a namespace (and not attached):
 [1] tidyselect_1.2.1        viridisLite_0.4.2       phytools_2.1-1         
 [4] optimParallel_1.0-2     fastmap_1.1.1           lazyeval_0.2.2         
 [7] combinat_0.0-8          digest_0.6.35           timechange_0.3.0       
[10] lifecycle_1.0.4         magrittr_2.0.3          compiler_4.3.2         
[13] rlang_1.1.3             tools_4.3.2             igraph_2.0.3           
[16] utf8_1.2.4              yaml_2.3.8              data.table_1.15.4      
[19] knitr_1.45              phangorn_2.11.1         clusterGeneration_1.3.8
[22] htmlwidgets_1.6.4       mnormt_2.1.1            scatterplot3d_0.3-44   
[25] expm_0.999-9            withr_3.0.0             numDeriv_2016.8-1.1    
[28] grid_4.3.2              fansi_1.0.6             colorspace_2.1-0       
[31] scales_1.3.0            gtools_3.9.5            iterators_1.0.14       
[34] MASS_7.3-60.0.1         cli_3.6.2               rmarkdown_2.26         
[37] generics_0.1.3          rstudioapi_0.16.0       httr_1.4.7             
[40] tzdb_0.4.0              ape_5.8                 maps_3.4.2             
[43] parallel_4.3.2          cellranger_1.1.0        vctrs_0.6.5            
[46] Matrix_1.6-5            jsonlite_1.8.8          hms_1.1.3              
[49] foreach_1.5.2           glue_1.7.0              codetools_0.2-20       
[52] stringi_1.8.4           gtable_0.3.5            quadprog_1.5-8         
[55] munsell_0.5.1           pillar_1.9.0            htmltools_0.5.8.1      
[58] R6_2.5.1                doParallel_1.0.17       evaluate_0.23          
[61] lattice_0.22-6          Rcpp_1.0.12             fastmatch_1.1-4        
[64] coda_0.19-4.1           nlme_3.1-164            xfun_0.43              
[67] pkgconfig_2.0.3        </code></pre>
</div>
</div>
</section>
<section id="packages" class="slide level2">
<h2>Packages</h2>
<ul>
<li>There are thousands of available libraries (aka, <em>packages</em>) that can be used to perform very specific analyses and produce publication-grade graphical output.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a></a>sI <span class="ot">&lt;-</span> <span class="fu">sessionInfo</span>()</span>
<span id="cb19-2"><a></a>sI<span class="sc">$</span>basePkgs <span class="co"># look at the basic packages installed and loaded</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "stats"     "graphics"  "grDevices" "utils"     "datasets"  "methods"  
[7] "base"     </code></pre>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a></a><span class="co"># The following command provides a list of all packages that are installed</span></span>
<span id="cb21-2"><a></a><span class="fu">rownames</span>(<span class="fu">installed.packages</span>()) <span class="co"># the output is from my computer and mybe different for you</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] "abc"                   "abc.data"              "abind"                
  [4] "ade4"                  "adegenet"              "adehabitatHR"         
  [7] "adehabitatHS"          "adehabitatLT"          "adehabitatMA"         
 [10] "ADGofTest"             "afex"                  "AHMbook"              
 [13] "AICcmodavg"            "alphahull"             "amap"                 
 [16] "AmesHousing"           "amt"                   "animation"            
 [19] "AnnotationDbi"         "AnnotationFilter"      "anytime"              
 [22] "ape"                   "apex"                  "aphid"                
 [25] "aplot"                 "aqp"                   "ash"                  
 [28] "askpass"               "assertthat"            "automap"              
 [31] "av"                    "aws.s3"                "aws.signature"        
 [34] "backports"             "base"                  "base64enc"            
 [37] "BayesFactor"           "bayestestR"            "BBmisc"               
 [40] "bbmle"                 "bcp"                   "bcpa"                 
 [43] "bdsmatrix"             "beeswarm"              "benchmarkme"          
 [46] "benchmarkmeData"       "Bessel"                "BH"                   
 [49] "bib2df"                "bibtex"                "bigD"                 
 [52] "binom"                 "Biobase"               "BiocFileCache"        
 [55] "BiocGenerics"          "BiocIO"                "BiocManager"          
 [58] "BiocParallel"          "BiocStyle"             "BiocVersion"          
 [61] "biomaRt"               "biomformat"            "bios2mds"             
 [64] "Biostrings"            "biovizBase"            "bit"                  
 [67] "bit64"                 "bitops"                "blob"                 
 [70] "blogdown"              "bmp"                   "bold"                 
 [73] "bookdown"              "boot"                  "bootstrap"            
 [76] "brew"                  "brio"                  "broom"                
 [79] "broom.helpers"         "brotli"                "BSgenome"             
 [82] "bslib"                 "ca"                    "cachem"               
 [85] "calendR"               "calibrate"             "callr"                
 [88] "car"                   "carData"               "caret"                
 [91] "caTools"               "cellranger"            "CENFA"                
 [94] "changepoint"           "checkmate"             "chron"                
 [97] "circlize"              "CircStats"             "circular"             
[100] "class"                 "classInt"              "cli"                  
[103] "clipr"                 "clock"                 "clue"                 
[106] "cluster"               "clusterGeneration"     "ClusterR"             
[109] "clv"                   "coalescentMCMC"        "coda"                 
[112] "codetools"             "colordistance"         "colorRamps"           
[115] "colorspace"            "combinat"              "commonmark"           
[118] "compiler"              "conditionz"            "config"               
[121] "conflicted"            "contfrac"              "copula"               
[124] "corpcor"               "correlation"           "corrplot"             
[127] "countcolors"           "countdown"             "cowplot"              
[130] "cpp11"                 "cranlogs"              "crayon"               
[133] "credentials"           "crosstalk"             "crul"                 
[136] "ctmm"                  "curl"                  "dashCoreComponents"   
[139] "data.table"            "datasets"              "datawizard"           
[142] "DBI"                   "dbplyr"                "dbscan"               
[145] "DDRTree"               "decido"                "DECIPHER"             
[148] "DelayedArray"          "deldir"                "dendextend"           
[151] "denstrip"              "DEoptimR"              "desc"                 
[154] "deSolve"               "devtools"              "diagram"              
[157] "DiagrammeR"            "dichromat"             "diffobj"              
[160] "diffusionMap"          "digest"                "diptest"              
[163] "dismo"                 "distributional"        "diyabcGUI"            
[166] "docopt"                "doMC"                  "doParallel"           
[169] "doSNOW"                "dotCall64"             "downlit"              
[172] "downloader"            "dplyr"                 "DT"                   
[175] "dtplyr"                "dtw"                   "e1071"                
[178] "ecodist"               "effects"               "effectsize"           
[181] "elevatr"               "ellipse"               "ellipsis"             
[184] "elliptic"              "emdbook"               "emdist"               
[187] "emmeans"               "ensembldb"             "EnvStats"             
[190] "estimability"          "evaluate"              "evd"                  
[193] "exactextractr"         "exactRankTests"        "excelR"               
[196] "expm"                  "extrafont"             "extrafontdb"          
[199] "factoextra"            "FactoMineR"            "fansi"                
[202] "farver"                "fastICA"               "fastmap"              
[205] "fastmatch"             "fastmatrix"            "fastqcr"              
[208] "fasttime"              "fBasics"               "fdrtool"              
[211] "fftwtools"             "fields"                "fiery"                
[214] "filehash"              "filelock"              "fitdistrplus"         
[217] "flashClust"            "flexmix"               "flextable"            
[220] "fmesher"               "FNN"                   "fontawesome"          
[223] "fontBitstreamVera"     "fontLiberation"        "fontquiver"           
[226] "forcats"               "foreach"               "forecast"             
[229] "foreign"               "forestError"           "formatR"              
[232] "formattable"           "Formula"               "fpc"                  
[235] "fpeek"                 "fracdiff"              "fs"                   
[238] "furrr"                 "futile.logger"         "futile.options"       
[241] "future"                "future.apply"          "gap"                  
[244] "gap.datasets"          "gargle"                "gaston"               
[247] "gclus"                 "gdata"                 "gdistance"            
[250] "gdsfmt"                "gdtools"               "genepop"              
[253] "generics"              "genetics"              "GenomeInfoDb"         
[256] "GenomeInfoDbData"      "GenomicAlignments"     "GenomicFeatures"      
[259] "GenomicFiles"          "GenomicRanges"         "geojsonsf"            
[262] "geometries"            "geometry"              "geomorph"             
[265] "geoR"                  "geosphere"             "gert"                 
[268] "gfonts"                "GGally"                "gganimate"            
[271] "ggbeeswarm"            "ggdendro"              "ggeffects"            
[274] "ggforce"               "ggfun"                 "gggibbous"            
[277] "ggimage"               "ggmap"                 "ggnetwork"            
[280] "ggnewscale"            "ggplot2"               "ggplotify"            
[283] "ggpubr"                "ggraph"                "ggrepel"              
[286] "ggridges"              "ggsci"                 "ggsignif"             
[289] "ggsn"                  "ggspatial"             "ggstats"              
[292] "ggtext"                "ggthemes"              "ggtree"               
[295] "gh"                    "gifski"                "gitcreds"             
[298] "glasso"                "glmnet"                "GlobalOptions"        
[301] "globals"               "glue"                  "Gmedian"              
[304] "gmp"                   "goftest"               "googledrive"          
[307] "googlePolylines"       "googlesheets4"         "googleway"            
[310] "GOplot"                "gower"                 "gplots"               
[313] "graph4lg"              "graphics"              "graphlayouts"         
[316] "grDevices"             "grid"                  "gridBase"             
[319] "gridExtra"             "gridGraphics"          "gridSVG"              
[322] "gridtext"              "grImport2"             "gsl"                  
[325] "gss"                   "gstat"                 "gt"                   
[328] "gtable"                "gtExtras"              "gtools"               
[331] "gtsummary"             "haplotypes"            "hardhat"              
[334] "HardyWeinberg"         "haven"                 "HDInterval"           
[337] "hdrcde"                "here"                  "hexbin"               
[340] "hierfstat"             "highcharter"           "highr"                
[343] "HistData"              "Hmisc"                 "hms"                  
[346] "howmany"               "htmlTable"             "htmltools"            
[349] "htmlwidgets"           "httpcode"              "httpuv"               
[352] "httr"                  "httr2"                 "humaniformat"         
[355] "hwriter"               "hydroTSM"              "hypergeo"             
[358] "IDPmisc"               "ids"                   "igraph"               
[361] "igraphdata"            "imager"                "imputeTS"             
[364] "inbreedR"              "influenceR"            "ini"                  
[367] "INLA"                  "inline"                "insect"               
[370] "insight"               "intergraph"            "interp"               
[373] "intervals"             "ipred"                 "ips"                  
[376] "IRanges"               "irlba"                 "irr"                  
[379] "isoband"               "iterators"             "jackalope"            
[382] "jagsUI"                "jomo"                  "jpeg"                 
[385] "jqr"                   "jquerylib"             "jsonify"              
[388] "jsonlite"              "juicyjuice"            "kableExtra"           
[391] "KEGGREST"              "keras"                 "kernlab"              
[394] "KernSmooth"            "keyring"               "kknn"                 
[397] "km.ci"                 "kmer"                  "KMsurv"               
[400] "knitr"                 "ks"                    "labeling"             
[403] "labelled"              "lambda.r"              "later"                
[406] "lattice"               "latticeExtra"          "lava"                 
[409] "lavaan"                "lazyeval"              "leafem"               
[412] "leaflet"               "leaflet.providers"     "leafpop"              
[415] "leafsync"              "leaps"                 "learnPopGen"          
[418] "learnr"                "leastcostpath"         "leidenbase"           
[421] "lifecycle"             "linprog"               "listenv"              
[424] "lme4"                  "lmerTest"              "lmtest"               
[427] "locfdr"                "locfit"                "locpol"               
[430] "logger"                "longitudinalData"      "loo"                  
[433] "LPCM"                  "lpSolve"               "lubridate"            
[436] "lwgeom"                "magic"                 "magick"               
[439] "magrittr"              "MALDIquant"            "manipulate"           
[442] "mapdata"               "mapplots"              "mapproj"              
[445] "maps"                  "maptools"              "mapview"              
[448] "markdown"              "markovchain"           "MASS"                 
[451] "mathjaxr"              "Matrix"                "matrixcalc"           
[454] "MatrixGenerics"        "MatrixModels"          "matrixStats"          
[457] "maxstat"               "mclust"                "mcmcplots"            
[460] "MCMCvis"               "memoise"               "MEMSS"                
[463] "memuse"                "metadat"               "metafor"              
[466] "metagear"              "methods"               "Metrics"              
[469] "mgcv"                  "mice"                  "microsimr"            
[472] "mime"                  "miniUI"                "minqa"                
[475] "misc3d"                "mitml"                 "mitools"              
[478] "mixtools"              "mlmRev"                "mlr"                  
[481] "mmod"                  "mnormt"                "modeest"              
[484] "modelbased"            "ModelMetrics"          "modelr"               
[487] "modeltools"            "mongolite"             "move"                 
[490] "move2"                 "movecost"              "moveHMM"              
[493] "moveVis"               "msa"                   "msm"                  
[496] "multcomp"              "multcompView"          "multicool"            
[499] "multtest"              "munsell"               "mvtnorm"              
[502] "natserv"               "ncdf4"                 "network"              
[505] "nimble"                "nlme"                  "nloptr"               
[508] "NLP"                   "NMF"                   "nnet"                 
[511] "nortest"               "nothing"               "numDeriv"             
[514] "officer"               "openssl"               "openxlsx"             
[517] "optimParallel"         "optimx"                "Orcs"                 
[520] "ordinal"               "overlapping"           "padr"                 
[523] "paletteer"             "pan"                   "pander"               
[526] "parallel"              "parallelly"            "parallelMap"          
[529] "ParallelStructure"     "parameters"            "ParamHelpers"         
[532] "parsedate"             "patchwork"             "pbapply"              
[535] "pbivnorm"              "pbkrtest"              "pbs"                  
[538] "PBSmapping"            "pcaPP"                 "pdc"                  
[541] "pegas"                 "performance"           "permute"              
[544] "phangorn"              "pheatmap"              "photobiology"         
[547] "phyclust"              "phylobase"             "phylogram"            
[550] "phyloseq"              "phyloseqGraphTest"     "phytools"             
[553] "pillar"                "pinfsc50"              "pixmap"               
[556] "pkgbuild"              "pkgconfig"             "pkgdown"              
[559] "pkgload"               "pkgmaker"              "plogr"                
[562] "plot3D"                "plotKML"               "plotly"               
[565] "plotrix"               "plotROC"               "plyr"                 
[568] "PMA"                   "png"                   "polspline"            
[571] "polyclip"              "polynom"               "polysat"              
[574] "popbio"                "popgen"                "PopGenReport"         
[577] "poppr"                 "posterior"             "prabclus"             
[580] "pracma"                "praise"                "prettymapr"           
[583] "prettyunits"           "prismatic"             "pROC"                 
[586] "processx"              "prodlim"               "profvis"              
[589] "progress"              "progressr"             "promises"             
[592] "ProtGenerics"          "proxy"                 "ps"                   
[595] "pspline"               "psych"                 "purrr"                
[598] "pwr"                   "qap"                   "qgraph"               
[601] "qlcMatrix"             "qpdf"                  "quadprog"             
[604] "quantmod"              "quantreg"              "QuasR"                
[607] "QuickJSR"              "R.methodsS3"           "R.oo"                 
[610] "R.utils"               "R6"                    "ragg"                 
[613] "randomForest"          "ranger"                "RANN"                 
[616] "rapidjsonr"            "rappdirs"              "raster"               
[619] "rasterVis"             "ratelimitr"            "rayimage"             
[622] "rayrender"             "rayshader"             "rayvertex"            
[625] "rbenchmark"            "rbibutils"             "Rbowtie"              
[628] "Rcapture"              "rcmdcheck"             "RColorBrewer"         
[631] "Rcpp"                  "RcppArmadillo"         "RcppEigen"            
[634] "RcppNumerical"         "RcppParallel"          "RcppProgress"         
[637] "RcppThread"            "RcppTOML"              "RCurl"                
[640] "Rdpack"                "reactable"             "reactR"               
[643] "readbitmap"            "readr"                 "readxl"               
[646] "recapr"                "recipes"               "RefManageR"           
[649] "registry"              "rematch"               "rematch2"             
[652] "remotes"               "Renext"                "rentrez"              
[655] "renv"                  "reprex"                "reqres"               
[658] "reshape"               "reshape2"              "restfulr"             
[661] "reticulate"            "rex"                   "rgdal"                
[664] "rgeos"                 "rgl"                   "RgoogleMaps"          
[667] "rhdf5"                 "rhdf5filters"          "Rhdf5lib"             
[670] "Rhh"                   "Rhtslib"               "ritis"                
[673] "rjags"                 "rjson"                 "rlang"                
[676] "RLDNe"                 "rlist"                 "RMark"                
[679] "rmarkdown"             "rmetasim"              "Rmisc"                
[682] "Rmpfr"                 "rms"                   "rmutil"               
[685] "RMySQL"                "rnaturalearth"         "rnaturalearthdata"    
[688] "rncl"                  "RNeXML"                "rngtools"             
[691] "robustbase"            "rosm"                  "rotl"                 
[694] "routr"                 "roxygen2"              "rpart"                
[697] "rpart.plot"            "rphylopic"             "RPostgres"            
[700] "RPostgreSQL"           "rPref"                 "rprojroot"            
[703] "Rqc"                   "rredlist"              "RRPP"                 
[706] "rsample"               "Rsamtools"             "Rsolnp"               
[709] "RSpectra"              "RSQLite"               "rstan"                
[712] "rstatix"               "rstudioapi"            "Rsubread"             
[715] "rsvd"                  "rsvg"                  "rtracklayer"          
[718] "Rtsne"                 "Rttf2pt1"              "RUnit"                
[721] "runjags"               "rversions"             "rvest"                
[724] "rworldmap"             "rworldxtra"            "s2"                   
[727] "S4Arrays"              "S4Vectors"             "sandwich"             
[730] "sangeranalyseR"        "sangerseqR"            "sass"                 
[733] "satellite"             "scales"                "scatterpie"           
[736] "scatterplot3d"         "sdamr"                 "secr"                 
[739] "see"                   "segmented"             "segmenTier"           
[742] "selectr"               "seqinr"                "seriation"            
[745] "servr"                 "sessioninfo"           "sf"                   
[748] "sfheaders"             "sfsmisc"               "sftime"               
[751] "sgeostat"              "shape"                 "shiny"                
[754] "shinyBS"               "shinybusy"             "shinycssloaders"      
[757] "shinydashboard"        "shinyFeedback"         "shinyFiles"           
[760] "shinyhelper"           "shinyjs"               "shinythemes"          
[763] "shinyWidgets"          "ShortRead"             "showtext"             
[766] "showtextdb"            "SIBER"                 "signal"               
[769] "sjlabelled"            "sjmisc"                "sjPlot"               
[772] "sjstats"               "slam"                  "slider"               
[775] "slippymath"            "smatr"                 "sn"                   
[778] "sna"                   "snow"                  "SNPRelate"            
[781] "snpStats"              "sodium"                "softImpute"           
[784] "solrium"               "sourcetools"           "sp"                   
[787] "spacefillr"            "spacetime"             "spam"                 
[790] "SparseM"               "sparsesvd"             "spatial"              
[793] "spatialEco"            "SpatialPack"           "spatstat"             
[796] "spatstat.data"         "spatstat.explore"      "spatstat.geom"        
[799] "spatstat.linnet"       "spatstat.model"        "spatstat.random"      
[802] "spatstat.sparse"       "spatstat.utils"        "spData"               
[805] "spDataLarge"           "spdep"                 "splancs"              
[808] "splines"               "splus2R"               "sprex"                
[811] "SQUAREM"               "stable"                "stabledist"           
[814] "StanHeaders"           "stars"                 "statip"               
[817] "statmod"               "statnet.common"        "stats"                
[820] "stats4"                "stinepack"             "stringdist"           
[823] "stringi"               "stringr"               "SummarizedExperiment" 
[826] "suncalc"               "survey"                "survival"             
[829] "survminer"             "survMisc"              "svglite"              
[832] "swfscMisc"             "sys"                   "sysfonts"             
[835] "systemfonts"           "taxize"                "taxonomizr"           
[838] "tcltk"                 "tensor"                "tensorA"              
[841] "tensorflow"            "terra"                 "terrainmeshr"         
[844] "testthat"              "textshaping"           "tfautograph"          
[847] "tfruns"                "TH.data"               "tibble"               
[850] "tidygraph"             "tidyr"                 "tidyselect"           
[853] "tidytree"              "tidyverse"             "tiff"                 
[856] "timechange"            "timeDate"              "timeSeries"           
[859] "tinytex"               "tkrplot"               "tm"                   
[862] "tmap"                  "tmaptools"             "TMB"                  
[865] "tmvnsim"               "tools"                 "trajectories"         
[868] "trajr"                 "transformr"            "treeio"               
[871] "triebeard"             "tripack"               "truncnorm"            
[874] "TSclust"               "tseries"               "TSP"                  
[877] "TTR"                   "tweenr"                "tzdb"                 
[880] "ucminf"                "units"                 "unmarked"             
[883] "urca"                  "urlchecker"            "urltools"             
[886] "usethis"               "utf8"                  "utils"                
[889] "uuid"                  "V8"                    "VariantAnnotation"    
[892] "vcd"                   "vcfR"                  "vctrs"                
[895] "vegan"                 "VGAM"                  "vipor"                
[898] "viridis"               "viridisLite"           "visNetwork"           
[901] "vroom"                 "wakefield"             "waldo"                
[904] "warp"                  "wavelets"              "webshot"              
[907] "webutils"              "wesanderson"           "whisker"              
[910] "widgetframe"           "WikidataQueryServiceR" "WikidataR"            
[913] "WikipediR"             "wikitaxa"              "WILD3810"             
[916] "withr"                 "wk"                    "wordcloud"            
[919] "wordcloud2"            "worrms"                "wosr"                 
[922] "xaringan"              "xfun"                  "xgboost"              
[925] "xkcd"                  "XML"                   "xml2"                 
[928] "xopen"                 "xtable"                "xts"                  
[931] "XVector"               "yaImpute"              "yaml"                 
[934] "yarrr"                 "yulab.utils"           "zeallot"              
[937] "zip"                   "zlibbioc"              "zoo"                  </code></pre>
</div>
</div>
</section>
<section class="slide level2">

<h4 id="how-to-install-new-packages">How to install new packages</h4>
<ul>
<li>Most packages can be installed using the following procedure</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a></a><span class="fu">install.packages</span>(<span class="st">"ggplot2"</span>, <span class="at">repos =</span> <span class="st">"https://cloud.r-project.org"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Once the package has been installed without any error as output, it should be available and can be loaded as a library in your working session</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a></a><span class="fu">library</span>(ggplot2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Once the library is loaded it is possible to star using the functions that are contained within the library</li>
<li><strong>R</strong> comes with a great help system that everybody is encouraged to read extensively and consult every time they are experiencing issues when running some code or using a function.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a></a>?geom_segment</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="loading-the-data-in-to-r" class="slide level2">
<h2>Loading the data in to <strong>R</strong></h2>
<ul>
<li>We can read excel files in <strong>R</strong>, but we first need to install and load a specific library that can help us doing that</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a></a><span class="fu">install.packages</span>(<span class="st">"readxl"</span>, <span class="at">repos =</span> <span class="st">"https://cloud.r-project.org"</span>)</span>
<span id="cb26-2"><a></a><span class="fu">library</span>(readxl)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>Now that the library is loaded we can load the excel file</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a></a>kestrel <span class="ot">&lt;-</span> <span class="fu">read_excel</span>(<span class="st">"/PATH/TO/EXCEL/FILE/Groombridge_et_al_genotypes_data.xlsx"</span>,</span>
<span id="cb27-2"><a></a>           <span class="at">sheet =</span> <span class="dv">1</span>, <span class="at">col_types =</span> <span class="st">"guess"</span>, <span class="at">na =</span> <span class="st">"</span><span class="sc">\\</span><span class="st">N"</span>)</span>
<span id="cb27-3"><a></a>kestrel</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 153 × 27
   ID      Species   Info  MS1_A MS1_B MS2_A MS2_B MS3_A MS3_B MS4_A MS4_B MS5_A
   &lt;chr&gt;   &lt;chr&gt;     &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 Kest_1  F.puncta… Muse…   110   110   134   134   210   210    97    97   136
 2 Kest_2  F.puncta… Muse…   108   108    NA    NA   176   176    97    97    NA
 3 Kest_3  F.puncta… Muse…   110   108   108   108   228   222    97    97   136
 4 Kest_4  F.puncta… Muse…   110   108   108   108   180   180    97    97   136
 5 Kest_5  F.puncta… Muse…   110   108   108   108   222   210    97    97   136
 6 Kest_6  F.puncta… Muse…   108   108    NA    NA    NA    NA    97    97    NA
 7 Kest_7  F.puncta… Muse…   108   108   134   134   216   216    97    97    NA
 8 Kest_8  F.puncta… Muse…   108   108   134   134   210   192    97    97    NA
 9 Kest_9  F.puncta… Muse…   110   108   136   134   228   216    97    97   136
10 Kest_10 F.puncta… Muse…   108   108    NA    NA    NA    NA    97    97   136
# ℹ 143 more rows
# ℹ 15 more variables: MS5_B &lt;dbl&gt;, MS6_A &lt;dbl&gt;, MS6_B &lt;dbl&gt;, MS7_A &lt;dbl&gt;,
#   MS7_B &lt;dbl&gt;, MS8_A &lt;dbl&gt;, MS8_B &lt;dbl&gt;, MS9_A &lt;dbl&gt;, MS9_B &lt;dbl&gt;,
#   MS10_A &lt;dbl&gt;, MS10_B &lt;dbl&gt;, MS11_A &lt;dbl&gt;, MS11_B &lt;dbl&gt;, MS12_A &lt;dbl&gt;,
#   MS12_B &lt;dbl&gt;</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<ul>
<li><p>Data is organized in a tibble, a data frame with some extra features when compared to regular data frames</p></li>
<li><p>We can summarize the second and third column to overview the type and number of sample</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a></a><span class="fu">table</span>(kestrel<span class="sc">$</span>Species, kestrel<span class="sc">$</span>Info)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 
                  Canary Island Kestrel European Kestrel Greater Kestrel
  F. newtoni                          0                0               0
  F.araea                             0                0               0
  F.naumanni                          0                0               0
  F.punctatus                         0                0               0
  F.rupicoloides                      0                0              10
  F.t.canariensis                     4                0               0
  F.t.dacotiae                        4                0               0
  F.t.rufescens                       0                0               0
  F.t.rupicolus                       0                0               0
  F.t.tinnunculus                     0               10               0
                 
                  Kestrel Lesser Kestrel Madagascan Kestrel Mauritius
  F. newtoni            0              0                  1         0
  F.araea               0              0                  0         0
  F.naumanni            0              8                  0         0
  F.punctatus           0              0                  0        75
  F.rupicoloides        0              0                  0         0
  F.t.canariensis       0              0                  0         0
  F.t.dacotiae          0              0                  0         0
  F.t.rufescens         1              0                  0         0
  F.t.rupicolus         0              0                  0         0
  F.t.tinnunculus       0              0                  0         0
                 
                  Museum Skin SA Rock Kestrel Seychelles Kestrel
  F. newtoni                0               0                  0
  F.araea                   0               0                  4
  F.naumanni                0               0                  0
  F.punctatus              26               0                  0
  F.rupicoloides            0               0                  0
  F.t.canariensis           0               0                  0
  F.t.dacotiae              0               0                  0
  F.t.rufescens             0               0                  0
  F.t.rupicolus             0              10                  0
  F.t.tinnunculus           0               0                  0</code></pre>
</div>
</div>
<ul>
<li>The results tell us that there are 6 different species of kestrel (and 5 subspecies), coming from various locations. For each species (or subspecies) the number indicates how many samples of that species are in the dataframe</li>
</ul>
</section>
<section class="slide level2">

<ul>
<li><p>We can now start looking at the actual genetic information. We will be using a package called <strong>hierfstat</strong> <span class="citation" data-cites="Goudet2005">(<a href="#/references" role="doc-biblioref" onclick="">Goudet, 2005</a>)</span>.</p></li>
<li><p>This package is a little outdated and there are some problems in the way some of the functions in this package handle the data!!!!</p></li>
<li><p>The package, if properly used, it is still pretty valuable and performs many useful analysis</p></li>
<li><p>In today’s excercise what you will do is try to modify the format of some data and run a simple function from the package to count the number of alleles in the different populations</p></li>
<li><p>The idea is to try and figure out the issue in the way the data are handled by the function that counts the number of alleles</p></li>
</ul>
</section>
<section class="slide level2">

<ul>
<li>Install the package and load it in your working session.</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a></a><span class="fu">install.packages</span>(<span class="st">"hierfstat"</span>)</span>
<span id="cb31-2"><a></a><span class="fu">library</span>(hierfstat)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>With the package installation also come a series of example data. We can look at one of the explanatory files to make sure our samples are properly formatted for the analysis</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a></a><span class="fu">data</span>(gtrunchier)</span>
<span id="cb32-2"><a></a>gtrunchier</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    Locality Patch L21.V L37.J L20.B L29.V L36.B L16.J
1          1     1    22    11    11    11    55    55
2          1     1    77    11    55    11    22    55
3          1     1    22    11    55    22    55    55
4          1     1    77    11    55    11    22    55
5          1     1    27    23    55    22    22    57
6          1     1    22    11    55    22    55    55
7          1     1    22    11    11    11    55    55
8          1     1    77    22    55    11    22    77
9          1     1    22    11    55    22    22    55
10         1     1    77    22    55    11    22    77
11         1     1    22    22    55    22    55    77
12         1     1    27    23    55    22    22    55
13         1     1    77    11    55    11    22    55
14         1     2    22    22    55    22    55    77
15         1     2    22    22    11    11    22    77
16         1     2    22    11    55    22    55    55
17         1     2    22    11    55    22    22    57
18         1     2    22    22    55    22    55    77
19         1     2    22    22    11    11    22    77
20         1     2    27    11    55    22    22    55
21         1     2    22    11    55    22    22    55
22         1     2    22    11    55    22    55    55
23         1     2    27    11    55    22    22    55
24         1     2    22    11    55    22    22    55
25         1     2    22    11    55    22    22    55
26         1     3    22    13    35    NA    11    55
27         1     3    22    11    55    22    22    55
28         1     3    36    33    55    22    22    55
29         1     3    66    33    55    44    22    55
30         1     3    66    33    55    44    22    55
31         1     3    24    23    55    45    22    56
32         1     3    24    11    35    44    33    15
33         1     3    24    33    35    45    11    55
34         1     3    44    11    55    44    33    55
35         1     3    66    11    55    44    33    11
36         1     3    22    33    33    55    11    55
37         1     3    66    23    33    45    22    55
38         1     3    44    11    55    44    33    55
39         1     3    44    33    55    44    22    66
40         1     3    23    13    55    44    22    55
41         1     4    44    23    55    44    22    11
42         1     4    66    33    55    44    33    55
43         1     4    44    22    55    44    22    11
44         1     4    46    11    55    44    22    55
45         1     4    44    11    55    44    22    55
46         1     4    44    11    55    44    33    56
47         1     4    44    22    55    44    33    55
48         1     4    44    22    55    44    33    55
49         1     4    66    11    55    22    22    11
50         1     4    66    33    15    44    33    55
51         1     4    44    11    55    44    33    55
52         1     4    66    33    55    44    22    66
53         1     4    44    11    55    44    33    66
54         1     4    44    12    55    44    22    66
55         1     4    33    13    55    22    34    55
56         1     5    22    11    55    22    22    11
57         1     5    22    22    11    22    22    11
58         1     5    22    11    55    22    22    11
59         1     5    22    11    55    22    22    11
60         1     5    22    11    55    22    22    11
61         1     5    22    22    11    22    22    11
62         1     5    22    22    11    22    22    11
63         1     5    22    11    15    22    22    11
64         1     5    22    11    15    22    22    11
65         1     5    22    11    15    22    22    11
66         1     5    22    11    55    22    44    11
67         1     5    22    11    11    22    22    11
68         1     5    22    11    55    22    22    11
69         2     6    55    11    55    44    NA    11
70         2     6    55    11    55    44    22    99
71         2     6    55    11    55    44    22    11
72         2     6    55    11    55    44    22    11
73         2     6    55    11    55    44    22    99
74         2     6    55    11    55    44    22    99
75         2     6    55    11    55    44    22    11
76         2     6    55    11    55    44    22    11
77         2     6    55    11    55    44    22    99
78         2     6    55    11    55    44    22    11
79         2     6    55    11    55    NA    22    11
80         2     6    55    11    55    NA    22    11
81         2     7    55    11    55    44    22    99
82         2     7    55    11    55    44    22    11
83         2     7    55    11    55    44    22    11
84         2     7    55    11    55    44    22    11
85         2     7    55    11    55    44    22    11
86         2     7    55    11    55    44    22    11
87         2     7    55    11    55    44    22    11
88         2     7    55    11    55    44    22    11
89         2     7    55    11    55    NA    22    11
90         2     7    55    11    55    44    22    11
91         2     7    55    11    55    NA    22    11
92         2     7    55    11    55    44    22    11
93         2     7    55    11    55    44    22    11
94         2     7    55    11    66    NA    22    11
95         2     7    55    11    55    44    22    11
96         2     8    55    11    55    NA    22    11
97         2     8    55    11    55    NA    22    11
98         2     8    55    11    55    44    22    11
99         2     8    55    11    55    44    22    11
100        2     8    55    11    55    NA    22    11
101        2     8    55    11    55    44    22    11
102        2     8    55    11    55    44    22    11
103        2     8    55    11    55    44    22    11
104        2     8    NA    11    55    NA    22    11
105        2     8    55    11    55    44    22    11
106        2     8    55    11    55    NA    22    11
107        2     8    55    11    55    44    22    11
108        2     8    55    11    55    NA    22    11
109        2     8    55    11    55    NA    22    11
110        2     9    55    11    55    44    22    11
111        2     9    55    11    55    44    22    11
112        2     9    55    11    55    44    22    11
113        2     9    55    11    55    44    22    11
114        2     9    55    11    55    44    22    99
115        2     9    55    11    55    44    22    11
116        2     9    55    11    55    44    22    11
117        2     9    55    11    55    44    22    11
118        2     9    55    11    55    44    22    11
119        2     9    55    11    55    44    22    11
120        2     9    55    11    55    44    22    11
121        2     9    55    NA    NA    44    22    NA
122        2     9    55    NA    NA    44    NA    NA
123        2    10    55    11    55    44    22    11
124        2    10    55    11    55    44    22    11
125        2    10    55    11    55    44    22    11
126        2    10    55    11    55    44    22    11
127        2    10    55    11    55    44    22    11
128        2    10    55    11    55    44    22    11
129        2    10    55    11    55    44    22    11
130        2    10    55    11    55    44    22    11
131        2    10    55    11    55    44    22    11
132        2    10    55    11    55    44    22    11
133        2    10    55    11    55    44    22    11
134        2    10    55    11    66    44    NA    NA
135        2    10    55    11    55    44    22    11
136        2    10    55    11    55    44    22    11
137        2    10    55    11    55    44    22    11
138        3    11    22    22    44    33    22    33
139        3    11    66    22    44    44    44    23
140        3    11    66    22    44    33    22    33
141        3    11    66    22    44    44    33    22
142        3    11    22    22    44    33    22    33
143        3    11    66    22    44    44    33    22
144        3    11    22    22    44    11    44    33
145        3    11    22    22    55    33    22    33
146        3    11    22    22    44    11    44    33
147        3    11    22    22    44    11    44    33
148        3    11    22    22    44    11    44    33
149        3    12    22    22    44    33    22    33
150        3    12    22    22    44    33    22    33
151        3    12    66    22    44    44    33    22
152        3    12    66    22    44    44    33    22
153        3    12    66    22    44    33    33    22
154        3    12    22    22    44    33    22    33
155        3    12    66    22    44    44    33    22
156        3    12    22    22    44    33    22    33
157        3    12    22    22    44    11    33    33
158        3    12    22    22    44    33    33    23
159        3    12    22    22    44    11    33    33
160        3    13    66    22    44    34    33    22
161        3    13    66    22    44    44    33    22
162        3    13    22    22    55    33    36    33
163        3    13    66    22    44    44    33    22
164        3    13    66    22    44    33    33    22
165        3    13    66    22    44    44    33    22
166        3    13    66    22    44    44    33    22
167        3    13    66    22    44    44    33    22
168        3    13    66    22    44    44    33    22
169        3    13    66    22    44    44    33    22
170        3    13    22    22    44    33    22    33
171        3    13    16    22    44    44    33    22
172        3    13    22    22    44    33    33    22
173        3    14    15    22    44    44    33    22
174        3    14    66    22    44    44    33    22
175        3    14    22    22    44    11    44    33
176        3    14    66    22    44    44    33    22
177        3    14    22    22    44    33    22    33
178        3    14    66    22    44    44    55    22
179        3    14    22    22    44    33    22    23
180        3    14    66    22    44    33    33    22
181        3    14    66    22    44    44    33    22
182        3    14    66    22    44    44    33    22
183        3    14    22    22    44    33    22    33
184        3    14    66    22    44    33    33    22
185        3    14    66    22    44    44    33    22
186        4    15    55    33    55    11    77    77
187        4    15    55    33    55    11    33    77
188        4    15    55    33    55    22    33    66
189        4    15    55    23    55    11    33    77
190        4    15    55    33    55    11    77    77
191        4    15    55    33    55    11    77    77
192        4    15    55    33    55    11    77    77
193        4    15    55    33    55    11    77    77
194        4    15    22    33    55    44    77    77
195        4    15    55    33    55    11    33    77
196        4    15    55    33    55    11    77    77
197        4    15    55    33    55    11    33    77
198        4    15    55    33    55    11    77    77
199        4    15    55    33    55    11    77    77
200        4    16    55    33    55    11    37    37
201        4    16    55    23    55    11    67    77
202        4    16    55    22    55    11    77    37
203        4    16    55    33    55    11    77    77
204        4    16    55    33    55    22    33    66
205        4    16    55    33    55    22    33    66
206        4    16    55    33    55    44    33    77
207        4    16    55    33    55    11    77    77
208        4    16    55    33    55    11    77    77
209        4    16    55    22    55    11    33    77
210        4    16    55    33    55    12    37    66
211        4    16    55    23    55    11    37    77
212        4    16    55    33    55    11    77    77
213        4    16    22    33    55    44    77    33
214        4    16    55    33    55    11    33    77
215        4    17    55    33    55    11    33    77
216        4    17    55    22    55    11    77    77
217        4    17    55    33    55    11    33    77
218        4    17    55    33    55    11    33    77
219        4    17    55    33    55    11    33    77
220        4    17    55    33    55    11    33    77
221        4    17    55    33    55    11    33    77
222        4    17    55    33    55    22    33    66
223        4    17    55    33    55    11    33    77
224        4    17    55    33    55    22    33    77
225        4    17    55    33    55    11    33    77
226        4    17    55    33    55    11    33    66
227        4    17    55    33    55    11    22    77
228        4    17    55    22    55    11    77    77
229        4    17    55    33    55    11    33    67
230        4    18    55    33    55    11    33    77
231        4    18    55    33    55    11    33    77
232        4    18    55    33    55    11    33    77
233        4    18    55    33    55    11    33    77
234        4    18    55    33    55    11    33    66
235        4    18    55    33    55    11    33    77
236        4    18    55    33    55    11    33    77
237        4    18    55    33    55    11    33    77
238        4    18    55    33    55    11    33    77
239        4    18    55    33    55    11    22    77
240        4    18    55    33    55    11    33    66
241        4    18    55    33    55    11    33    77
242        4    18    55    23    55    11    33    77
243        4    18    55    23    55    12    33    66
244        4    18    55    33    55    11    33    66
245        4    19    22    33    55    11    33    77
246        4    19    25    33    55    12    33    67
247        4    19    22    33    55    11    33    66
248        4    19    22    33    55    11    33    66
249        4    19    55    33    55    22    33    66
250        4    19    55    33    55    22    33    66
251        4    19    55    33    55    11    77    77
252        4    19    25    23    55    11    33    66
253        4    19    55    33    55    22    33    66
254        4    19    55    33    55    11    66    33
255        4    19    55    22    55    22    33    66
256        4    19    55    33    55    11    33    77
257        4    19    22    33    55    11    33    67
258        5    20    33    11    55    11    44    77
259        5    20    22    33    55    11    55    11
260        5    20    33    11    55    22    44    11
261        5    20    33    11    55    11    44    17
262        5    20    33    11    55    11    45    11
263        5    20    33    13    55    12    45    11
264        5    20    33    33    55    11    44    11
265        5    20    33    11    55    11    44    77
266        5    20    33    11    55    12    44    11
267        5    20    33    33    55    11    44    11
268        5    20    33    11    55    11    44    77
269        5    20    23    13    15    22    45    17
270        5    20    22    11    55    11    44    11
271        5    20    33    11    11    NA    44    NA
272        5    21    35    11    15    12    44    17
273        5    21    33    11    11    22    44    77
274        5    21    33    11    11    22    44    77
275        5    21    33    11    11    22    44    77
276        5    21    33    11    15    22    44    17
277        5    21    33    11    11    22    44    77
278        5    21    33    11    11    11    44    11
279        5    21    35    11    15    12    44    11
280        5    21    33    11    11    11    44    11
281        5    21    35    11    55    22    44    17
282        5    21    22    11    15    11    44    11
283        5    21    33    11    11    22    44    77
284        5    21    33    11    11    22    44    77
285        5    21    33    11    55    11    55    11
286        5    21    55    11    55    11    44    11
287        5    22    55    11    11    11    55    11
288        5    22    55    11    11    11    55    11
289        5    22    55    11    11    11    66    11
290        5    22    55    11    11    11    66    11
291        5    22    55    11    11    11    66    11
292        5    22    55    11    11    11    66    11
293        5    22    55    11    11    11    55    11
294        5    22    55    11    11    11    66    11
295        5    22    55    11    11    11    66    11
296        5    22    55    11    11    11    55    11
297        5    22    55    11    11    11    56    11
298        5    22    55    11    11    11    66    11
299        5    22    55    11    11    11    66    11
300        5    22    55    11    11    11    66    11
301        5    23    22    11    11    11    45    11
302        5    23    22    33    55    11    44    11
303        5    23    22    11    11    11    55    11
304        5    23    22    33    55    11    44    11
305        5    23    22    11    11    11    44    77
306        5    23    22    11    11    11    55    11
307        5    23    33    11    15    12    45    11
308        5    23    22    11    11    12    44    11
309        5    23    33    11    11    22    44    77
310        5    23    33    11    55    11    44    77
311        5    23    NA    NA    55    NA    22    11
312        5    23    33    11    55    22    44    77
313        5    23    33    11    11    22    44    11
314        5    23    22    11    55    22    44    11
315        5    23    33    11    11    11    55    11
316        5    24    55    11    11    11    55    11
317        5    24    55    11    11    11    66    11
318        5    24    55    11    11    11    55    11
319        5    24    55    11    11    11    66    11
320        5    24    55    11    11    11    55    11
321        5    24    55    11    11    11    55    11
322        5    24    55    11    11    11    66    11
323        5    24    55    11    11    11    55    11
324        5    24    55    11    11    11    55    11
325        5    24    55    11    11    11    55    11
326        5    24    55    11    11    11    55    11
327        5    24    55    11    11    11    55    11
328        5    24    55    11    11    11    55    11
329        5    24    55    11    11    11    66    11
330        5    24    55    11    11    11    66    11
331        6    25    22    33    66    33    66    22
332        6    25    55    33    66    55    66    22
333        6    25    55    22    55    22    66    22
334        6    25    55    33    55    33    66    22
335        6    25    55    33    55    23    66    12
336        6    25    55    33    55    35    66    22
337        6    25    55    33    55    22    66    22
338        6    25    55    22    55    33    36    12
339        6    25    25    33    55    23    66    22
340        6    25    25    33    55    33    66    22
341        6    25    55    33    55    33    66    22
342        6    25    55    33    55    22    66    22
343        6    26    55    23    55    33    66    22
344        6    26    22    23    55    33    36    12
345        6    26    25    23    56    33    66    12
346        6    26    25    33    55    33    66    22
347        6    26    55    23    56    23    56    22
348        6    26    22    22    55    33    33    22
349        6    26    22    33    55    33    66    22
350        6    26    55    33    55    33    66    12
351        6    27    55    33    55    55    66    11
352        6    27    25    33    56    55    33    11
353        6    27    55    22    55    22    66    22
354        6    27    55    33    55    22    66    22
355        6    27    55    33    55    33    36    22
356        6    27    55    23    55    23    66    22
357        6    27    55    22    55    23    36    22
358        6    27    25    33    55    23    66    22
359        6    27    25    33    55    35    66    22
360        6    27    55    33    55    33    33    12
361        6    28    55    33    55    33    66    11
362        6    28    22    22    55    33    66    22
363        6    28    55    33    55    33    66    22
364        6    28    25    33    55    35    66    22
365        6    28    55    33    56    23    56    12
366        6    29    55    33    55    22    66    22
367        6    29    25    33    56    33    66    22
368        6    29    55    33    55    33    33    11
369        6    29    22    23    55    55    66    12
370        6    29    55    33    56    33    36    12</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<ul>
<li><p>The example data contains genotypes at 6 microsatellite loci of <em>Galba truncatula</em>, an air-breathing freshwater snail, from different patches in Western Switzerland</p></li>
<li><p>The genotyped microsatellites data are organized so that one column contains 2 alleles. Lets take a look at the first sample in the dataframe. The first 2 columns contain sampling information (<span style="color: red;">Locality</span> and <span style="color: red;">Patch</span>), while the rest of the column contain the actual genotypes</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a></a>gtrunchier[<span class="dv">1</span>, ]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Locality Patch L21.V L37.J L20.B L29.V L36.B L16.J
1        1     1    22    11    11    11    55    55</code></pre>
</div>
</div>
<ul>
<li><p>So, the first individual is homozygous at locus <span style="color: blue;">L21.V</span> with two copies of allele <span style="color: green;">2</span></p></li>
<li><p>This individual is actually homozygous for all loci considered here. What is important to note at this stage is that the format of this data frame is slightly different from our data</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a></a><span class="fu">as.data.frame</span>(kestrel[<span class="dv">1</span>, ])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      ID     Species        Info MS1_A MS1_B MS2_A MS2_B MS3_A MS3_B MS4_A
1 Kest_1 F.punctatus Museum Skin   110   110   134   134   210   210    97
  MS4_B MS5_A MS5_B MS6_A MS6_B MS7_A MS7_B MS8_A MS8_B MS9_A MS9_B MS10_A
1    97   136   136   128   128   121   121   199   199   140   140    120
  MS10_B MS11_A MS11_B MS12_A MS12_B
1    120     NA     NA     NA     NA</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<ul>
<li><p>In our data the two alleles are kept in two separate columns, and each locus has an <span style="color: red;">_A</span> and <span style="color: red;">_B</span> notation to specify the two different alleles</p></li>
<li><p>So, the first thing to do to start the analysis with <em>hierfstat</em> is to modify the format of our data. Basically we need to make a new data frame with one column per locus</p></li>
<li><p>Please note that there are many different ways to achieve this, and what I am showing below is just one of the many available alternatives</p></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a></a><span class="co"># We first create an empy matrix that has the as mny rows as  number of samples in our dataset and </span></span>
<span id="cb38-2"><a></a><span class="co"># as many columns as number of genotyped loci</span></span>
<span id="cb38-3"><a></a>kestrel_df <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="at">nrow =</span> <span class="fu">nrow</span>(kestrel), <span class="at">ncol =</span> <span class="fu">length</span>(kestrel[, <span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(kestrel)])<span class="sc">/</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>We have just created an empty object and we can now proceed to fill it with the actual data. We can do so using a <strong>for</strong> loop</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(kestrel[, <span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(kestrel)]), <span class="dv">2</span>)) {</span>
<span id="cb39-2"><a></a>  <span class="cf">for</span> (y <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(kestrel)) {</span>
<span id="cb39-3"><a></a>    kestrel_df[y, <span class="fu">which</span>(<span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(kestrel[, <span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(kestrel)]), <span class="dv">2</span>) <span class="sc">==</span> i)] <span class="ot">&lt;-</span> </span>
<span id="cb39-4"><a></a>      <span class="fu">paste</span>(kestrel[, <span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(kestrel)][y, i], kestrel[, <span class="dv">4</span><span class="sc">:</span><span class="fu">ncol</span>(kestrel)][y, i<span class="sc">+</span><span class="dv">1</span>], <span class="at">sep =</span> <span class="st">""</span>) </span>
<span id="cb39-5"><a></a>  }</span>
<span id="cb39-6"><a></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<div class="cell">
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a></a>kestrel_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>       [,1]     [,2]     [,3]     [,4]     [,5]     [,6]     [,7]     [,8]    
  [1,] "110110" "134134" "210210" "9797"   "136136" "128128" "121121" "199199"
  [2,] "108108" "NANA"   "176176" "9797"   "NANA"   "NANA"   "NANA"   "NANA"  
  [3,] "110108" "108108" "228222" "9797"   "136136" "128128" "121121" "203199"
  [4,] "110108" "108108" "180180" "9797"   "136136" "NANA"   "121121" "NANA"  
  [5,] "110108" "108108" "222210" "9797"   "136136" "128128" "121121" "NANA"  
  [6,] "108108" "NANA"   "NANA"   "9797"   "NANA"   "128128" "121121" "NANA"  
  [7,] "108108" "134134" "216216" "9797"   "NANA"   "128128" "121121" "NANA"  
  [8,] "108108" "134134" "210192" "9797"   "NANA"   "128128" "121121" "NANA"  
  [9,] "110108" "136134" "228216" "9797"   "136136" "128128" "121121" "203203"
 [10,] "108108" "NANA"   "NANA"   "9797"   "136136" "128128" "121121" "NANA"  
 [11,] "108108" "136136" "NANA"   "9797"   "138136" "128128" "121121" "NANA"  
 [12,] "110108" "136134" "228222" "9797"   "136136" "128128" "NANA"   "203203"
 [13,] "108108" "134134" "252234" "9797"   "136136" "128128" "121121" "NANA"  
 [14,] "108108" "136134" "258222" "9797"   "136136" "128128" "121121" "207203"
 [15,] "108108" "136136" "252234" "9797"   "136136" "128128" "121121" "203197"
 [16,] "110108" "134134" "234228" "9797"   "136136" "128128" "121121" "203203"
 [17,] "108108" "136136" "228222" "9797"   "136136" "128128" "121121" "203197"
 [18,] "108108" "136136" "210210" "9797"   "136136" "128128" "121121" "207197"
 [19,] "108108" "134134" "246228" "9797"   "136136" "128128" "121121" "207199"
 [20,] "110108" "134134" "240240" "9797"   "136136" "128128" "121121" "203203"
 [21,] "110108" "136136" "246222" "9797"   "136136" "128128" "121121" "197197"
 [22,] "110108" "136134" "198192" "9797"   "136136" "128128" "121121" "197197"
 [23,] "108108" "NANA"   "NANA"   "9797"   "136136" "NANA"   "121121" "NANA"  
 [24,] "110108" "NANA"   "NANA"   "NANA"   "NANA"   "NANA"   "121121" "NANA"  
 [25,] "110108" "134134" "234198" "9797"   "136136" "128128" "121121" "203203"
 [26,] "110108" "134134" "222216" "9797"   "NANA"   "128128" "121121" "NANA"  
 [27,] "108108" "136134" "222222" "9797"   "136136" "128128" "121121" "203203"
 [28,] "110110" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [29,] "108108" "136136" "228222" "9797"   "136136" "128128" "121121" "203203"
 [30,] "108108" "136134" "210210" "9797"   "136136" "128128" "121121" "203203"
 [31,] "108108" "134134" "222210" "9797"   "136136" "128128" "121121" "203203"
 [32,] "108108" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [33,] "110108" "136134" "210210" "9797"   "136136" "128128" "121121" "203203"
 [34,] "110108" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [35,] "110108" "136136" "222210" "9797"   "136136" "128128" "121121" "203203"
 [36,] "108108" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [37,] "108108" "136136" "222210" "9797"   "136136" "128128" "121121" "203203"
 [38,] "108108" "136134" "210210" "9797"   "136136" "128128" "121121" "203203"
 [39,] "110108" "136134" "210210" "9797"   "136136" "128128" "121121" "203203"
 [40,] "108108" "136134" "228210" "9797"   "136136" "128128" "121121" "203203"
 [41,] "110108" "136136" "228210" "9797"   "136136" "128128" "121121" "203203"
 [42,] "108108" "136134" "228210" "9797"   "136136" "128128" "121121" "203203"
 [43,] "108108" "136134" "222210" "9797"   "136136" "128128" "121121" "203203"
 [44,] "110108" "136134" "222210" "9797"   "136136" "128128" "121121" "203203"
 [45,] "110108" "136136" "228228" "9797"   "136136" "128128" "121121" "203203"
 [46,] "108108" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [47,] "110108" "136136" "228210" "9797"   "136136" "128128" "121121" "203203"
 [48,] "108108" "136134" "210210" "9797"   "136136" "128128" "121121" "203203"
 [49,] "110108" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [50,] "108108" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [51,] "110108" "136134" "210210" "9797"   "136136" "128128" "121121" "203203"
 [52,] "108108" "136134" "210210" "9797"   "136136" "128128" "121121" "203203"
 [53,] "110110" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [54,] "108108" "136134" "210210" "9797"   "136136" "128128" "121121" "203203"
 [55,] "108108" "136134" "228210" "9797"   "136136" "128128" "121121" "203203"
 [56,] "110110" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [57,] "108108" "136134" "210210" "9797"   "136136" "128128" "121121" "203203"
 [58,] "108108" "136136" "228222" "9797"   "136136" "128128" "121121" "203203"
 [59,] "108108" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [60,] "108108" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [61,] "110110" "136136" "228210" "9797"   "136136" "128128" "121121" "203203"
 [62,] "110110" "136136" "228228" "9797"   "136136" "128128" "121121" "203203"
 [63,] "108108" "136134" "222222" "9797"   "136136" "128128" "121121" "203203"
 [64,] "108108" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [65,] "110108" "136136" "222210" "9797"   "136136" "128128" "121121" "203203"
 [66,] "108108" "134134" "228210" "9797"   "136136" "128128" "121121" "203203"
 [67,] "110108" "136134" "222210" "9797"   "136136" "128128" "121121" "203203"
 [68,] "108108" "136134" "222210" "9797"   "136136" "128128" "121121" "203203"
 [69,] "110108" "136134" "228210" "9797"   "136136" "128128" "121121" "203203"
 [70,] "110110" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [71,] "108108" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [72,] "110108" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [73,] "110108" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [74,] "110108" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [75,] "110108" "136134" "210210" "9797"   "136136" "128128" "121121" "203203"
 [76,] "108108" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [77,] "110108" "136136" "222210" "9797"   "136136" "128128" "121121" "203203"
 [78,] "108108" "136134" "210210" "9797"   "136136" "128128" "121121" "203203"
 [79,] "110108" "136134" "210210" "9797"   "136136" "128128" "121121" "203203"
 [80,] "110108" "136134" "222210" "9797"   "136136" "128128" "121121" "203203"
 [81,] "110108" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [82,] "110108" "136134" "210210" "9797"   "136136" "128128" "121121" "203203"
 [83,] "110110" "136134" "210210" "9797"   "136136" "128128" "121121" "203203"
 [84,] "108108" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [85,] "110108" "136134" "210210" "9797"   "136136" "128128" "121121" "203203"
 [86,] "110108" "136136" "222210" "9797"   "136136" "128128" "121121" "203203"
 [87,] "110110" "136134" "210210" "9797"   "136136" "128128" "121121" "203203"
 [88,] "110108" "136134" "228210" "9797"   "136136" "128128" "121121" "203203"
 [89,] "110108" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [90,] "108108" "136136" "222210" "9797"   "136136" "128128" "121121" "203203"
 [91,] "108108" "136134" "222222" "9797"   "136136" "128128" "121121" "203203"
 [92,] "110110" "136136" "228222" "9797"   "136136" "128128" "121121" "203203"
 [93,] "108108" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [94,] "110108" "136136" "222210" "9797"   "136136" "128128" "121121" "203203"
 [95,] "108108" "136136" "210210" "9797"   "136136" "128128" "121121" "203203"
 [96,] "110110" "136136" "228210" "9797"   "136136" "128128" "121121" "203203"
 [97,] "108108" "136134" "222210" "9797"   "136136" "128128" "121121" "203203"
 [98,] "108108" "136134" "222210" "9797"   "136136" "128128" "121121" "203203"
 [99,] "110108" "136136" "222210" "9797"   "136136" "128128" "121121" "203203"
[100,] "108108" "136136" "222210" "9797"   "136136" "128128" "121121" "203203"
[101,] "110108" "134134" "228210" "9797"   "136136" "128128" "121121" "203203"
[102,] "106106" "134134" "174174" "101101" "136136" "132132" "121121" "205205"
[103,] "106106" "134134" "174168" "101101" "136136" "132132" "121121" "205205"
[104,] "106106" "134134" "174174" "101101" "136136" "132132" "121121" "205205"
[105,] "106106" "134134" "174174" "101101" "136136" "132132" "121121" "205205"
[106,] "108106" "134134" "264216" "101101" "136136" "126132" "121121" "189189"
[107,] "106106" "138126" "258234" "9995"   "136136" "124124" "123121" "225225"
[108,] "106106" "132126" "246228" "9999"   "136136" "124124" "123121" "195195"
[109,] "108106" "134132" "306294" "9999"   "136136" "124124" "121119" "225221"
[110,] "110106" "126126" "276264" "9999"   "136136" "124124" "123121" "223199"
[111,] "106106" "132128" "300246" "9997"   "136136" "124124" "121121" "197197"
[112,] "106106" "126126" "264222" "9997"   "136136" "124124" "123121" "197197"
[113,] "106106" "134126" "264252" "9995"   "136136" "124124" "123121" "223197"
[114,] "106106" "132126" "276258" "9995"   "136134" "124124" "121119" "253253"
[115,] "108100" "138126" "270270" "9995"   "136136" "124124" "121119" "223223"
[116,] "106106" "126126" "300288" "9995"   "136136" "124124" "123121" "243197"
[117,] "112102" "134126" "252246" "9997"   "136136" "127123" "125125" "201201"
[118,] "112104" "132126" "246246" "9999"   "136136" "129124" "125121" "197197"
[119,] "104102" "126126" "276246" "9997"   "138136" "127123" "123123" "217201"
[120,] "108104" "126126" "276198" "9797"   "136136" "127121" "125121" "223197"
[121,] "118110" "134126" "276228" "9999"   "136136" "125123" "125121" "211211"
[122,] "106102" "132126" "276264" "9997"   "140136" "123123" "123121" "213205"
[123,] "108106" "134126" "258258" "9797"   "140136" "129123" "123121" "197197"
[124,] "110104" "132126" "264210" "105101" "136136" "129123" "125121" "205191"
[125,] "110106" "132126" "276228" "9999"   "140138" "123123" "123121" "223223"
[126,] "110110" "132126" "276246" "9997"   "140136" "129127" "121121" "211211"
[127,] "108104" "126126" "282198" "10599"  "136136" "131131" "123123" "229203"
[128,] "110104" "132132" "264264" "9999"   "140136" "127126" "119119" "211211"
[129,] "110110" "126126" "258221" "9999"   "140140" "126124" "121121" "211211"
[130,] "106102" "134134" "258221" "9999"   "136136" "125123" "121119" "203203"
[131,] "112110" "132132" "228210" "9797"   "140136" "126125" "121121" "211203"
[132,] "110104" "134126" "360258" "9797"   "140136" "126125" "121121" "211211"
[133,] "110104" "132132" "312216" "9997"   "140136" "126126" "121121" "211211"
[134,] "110104" "132126" "276228" "9999"   "140136" "127127" "127123" "211203"
[135,] "110104" "134126" "258221" "9997"   "140140" "126126" "121119" "213207"
[136,] "110110" "134134" "270234" "10197"  "138136" "127127" "127123" "281277"
[137,] "110108" "134134" "282221" "9797"   "138138" "128128" "127127" "281273"
[138,] "110110" "134134" "300222" "9797"   "136136" "128128" "129127" "253199"
[139,] "108108" "134134" "312276" "9797"   "142138" "125125" "131123" "189189"
[140,] "110108" "134134" "300221" "9797"   "136136" "127115" "123123" "189189"
[141,] "110106" "134134" "306226" "9797"   "144136" "128128" "127127" "287253"
[142,] "108108" "134134" "270222" "9797"   "136132" "127125" "127123" "267253"
[143,] "110108" "134134" "240234" "9797"   "138138" "127127" "127123" "277189"
[144,] "110110" "134134" "300276" "9797"   "132132" "128128" "125123" "291265"
[145,] "112108" "134134" "258234" "9797"   "136136" "128128" "127123" "213213"
[146,] "108106" "134134" "267267" "11191"  "132124" "137133" "123123" "225189"
[147,] "106102" "132132" "276270" "11197"  "144140" "135131" "123121" "191189"
[148,] "106106" "134134" "282252" "11197"  "138132" "135132" "127123" "203187"
[149,] "106106" "134134" "261225" "9191"   "132132" "127123" "123121" "199199"
[150,] "106100" "132128" "306294" "11197"  "140138" "131129" "127123" "199189"
[151,] "10894"  "134134" "288288" "9791"   "140138" "137133" "131123" "225187"
[152,] "110106" "134126" "324246" "9797"   "138138" "131125" "131123" "199191"
[153,] "108108" "128128" "300300" "11197"  "140130" "135129" "127123" "225201"
       [,9]     [,10]    [,11]    [,12]   
  [1,] "140140" "120120" "NANA"   "NANA"  
  [2,] "NANA"   "NANA"   "NANA"   "NANA"  
  [3,] "140140" "120120" "NANA"   "NANA"  
  [4,] "140140" "116116" "NANA"   "NANA"  
  [5,] "140140" "116116" "NANA"   "NANA"  
  [6,] "NANA"   "NANA"   "NANA"   "NANA"  
  [7,] "NANA"   "NANA"   "NANA"   "NANA"  
  [8,] "NANA"   "120116" "NANA"   "NANA"  
  [9,] "140140" "120120" "NANA"   "NANA"  
 [10,] "NANA"   "116116" "NANA"   "NANA"  
 [11,] "140140" "116116" "NANA"   "NANA"  
 [12,] "140140" "120116" "NANA"   "NANA"  
 [13,] "140140" "120116" "NANA"   "NANA"  
 [14,] "140140" "116116" "NANA"   "NANA"  
 [15,] "140140" "120116" "NANA"   "NANA"  
 [16,] "140140" "120116" "NANA"   "NANA"  
 [17,] "140140" "116116" "NANA"   "NANA"  
 [18,] "140140" "120116" "NANA"   "NANA"  
 [19,] "140140" "116116" "NANA"   "NANA"  
 [20,] "140140" "116116" "NANA"   "NANA"  
 [21,] "140140" "120116" "NANA"   "NANA"  
 [22,] "140140" "116116" "NANA"   "NANA"  
 [23,] "NANA"   "NANA"   "NANA"   "NANA"  
 [24,] "NANA"   "NANA"   "NANA"   "NANA"  
 [25,] "140140" "NANA"   "NANA"   "NANA"  
 [26,] "140140" "NANA"   "NANA"   "NANA"  
 [27,] "140140" "116116" "136136" "112112"
 [28,] "140140" "116116" "136136" "112112"
 [29,] "140140" "116116" "136136" "112112"
 [30,] "140140" "116116" "136136" "112112"
 [31,] "140140" "116116" "136136" "112112"
 [32,] "140140" "116116" "136136" "112112"
 [33,] "140140" "116116" "136136" "112112"
 [34,] "140140" "116116" "136136" "112112"
 [35,] "140140" "116116" "136136" "112112"
 [36,] "140140" "116116" "136136" "112112"
 [37,] "140140" "116116" "136136" "112112"
 [38,] "140140" "116116" "136136" "112112"
 [39,] "140140" "116116" "136136" "112112"
 [40,] "140140" "116116" "136136" "112112"
 [41,] "140140" "116116" "136136" "112112"
 [42,] "140140" "116116" "136136" "112112"
 [43,] "140140" "116116" "136136" "112112"
 [44,] "140140" "116116" "136136" "112112"
 [45,] "140140" "116116" "136136" "112112"
 [46,] "140140" "116116" "136136" "112112"
 [47,] "140140" "116116" "136136" "112112"
 [48,] "140140" "116116" "136136" "112112"
 [49,] "140140" "116116" "136136" "112112"
 [50,] "140140" "116116" "136136" "112112"
 [51,] "140140" "116116" "136136" "112112"
 [52,] "140140" "116116" "136136" "112112"
 [53,] "140140" "116116" "136136" "112112"
 [54,] "140140" "116116" "136136" "112112"
 [55,] "140140" "116116" "136136" "112112"
 [56,] "140140" "116116" "136136" "112112"
 [57,] "140140" "116116" "136136" "112112"
 [58,] "140140" "116116" "136136" "112112"
 [59,] "140140" "116116" "136136" "112112"
 [60,] "140140" "116116" "136136" "112112"
 [61,] "140140" "116116" "136136" "112112"
 [62,] "140140" "116116" "136136" "112112"
 [63,] "140140" "116116" "136136" "112112"
 [64,] "140140" "116116" "136136" "112112"
 [65,] "140140" "116116" "136136" "112112"
 [66,] "140140" "116116" "136136" "112112"
 [67,] "140140" "116116" "136136" "112112"
 [68,] "140140" "116116" "136136" "112112"
 [69,] "140140" "116116" "136136" "112112"
 [70,] "140140" "116116" "136136" "112112"
 [71,] "140140" "116116" "136136" "112112"
 [72,] "140140" "116116" "136136" "112112"
 [73,] "140140" "116116" "136136" "112112"
 [74,] "140140" "116116" "136136" "112112"
 [75,] "140140" "116116" "136136" "112112"
 [76,] "140140" "116116" "136136" "112112"
 [77,] "140140" "116116" "136136" "112112"
 [78,] "140140" "116116" "136136" "112112"
 [79,] "140140" "116116" "136136" "112112"
 [80,] "140140" "116116" "136136" "112112"
 [81,] "140140" "116116" "136136" "112112"
 [82,] "140140" "116116" "136136" "112112"
 [83,] "140140" "116116" "136136" "112112"
 [84,] "140140" "116116" "136136" "112112"
 [85,] "140140" "116116" "136136" "112112"
 [86,] "140140" "116116" "136136" "112112"
 [87,] "140140" "116116" "136136" "112112"
 [88,] "140140" "116116" "136136" "112112"
 [89,] "140140" "116116" "136136" "112112"
 [90,] "140140" "116116" "136136" "112112"
 [91,] "140140" "116116" "136136" "112112"
 [92,] "140140" "116116" "136136" "112112"
 [93,] "140140" "116116" "136136" "112112"
 [94,] "140140" "116116" "136136" "112112"
 [95,] "140140" "116116" "136136" "112112"
 [96,] "140140" "116116" "136136" "112112"
 [97,] "140140" "116116" "136136" "112112"
 [98,] "140140" "116116" "136136" "112112"
 [99,] "140140" "116116" "136136" "112112"
[100,] "140140" "116116" "136136" "112112"
[101,] "140140" "116116" "136136" "112112"
[102,] "136136" "116104" "138138" "100100"
[103,] "136136" "120104" "138138" "100100"
[104,] "136136" "120120" "138138" "100100"
[105,] "136136" "120120" "138138" "100100"
[106,] "136136" "128120" "138138" "100100"
[107,] "140136" "132124" "142142" "102102"
[108,] "142140" "132128" "142138" "102100"
[109,] "140140" "140128" "142142" "100100"
[110,] "140140" "132124" "140137" "114114"
[111,] "144140" "128124" "138136" "100100"
[112,] "146140" "124124" "142140" "114114"
[113,] "140140" "128128" "142142" "122116"
[114,] "146140" "128124" "142136" "102102"
[115,] "140140" "128128" "142136" "126116"
[116,] "144140" "128124" "138136" "100100"
[117,] "144134" "132124" "138136" "109100"
[118,] "134134" "136124" "138134" "110100"
[119,] "140136" "128124" "138138" "104100"
[120,] "136136" "124124" "140134" "109102"
[121,] "134132" "124124" "138138" "128128"
[122,] "134134" "128124" "142138" "102100"
[123,] "132132" "128128" "136136" "100100"
[124,] "138134" "124124" "138138" "100100"
[125,] "138132" "124124" "136136" "114100"
[126,] "138136" "116116" "138138" "132132"
[127,] "142136" "136132" "138138" "100100"
[128,] "136134" "128124" "138136" "102102"
[129,] "136134" "128124" "138138" "109100"
[130,] "144134" "124124" "138138" "109100"
[131,] "136136" "140124" "140140" "106106"
[132,] "142136" "128124" "138136" "114100"
[133,] "146134" "128124" "140138" "106106"
[134,] "136134" "132128" "138136" "132102"
[135,] "136136" "134124" "138138" "106106"
[136,] "134134" "104104" "138132" "100100"
[137,] "140136" "104104" "138138" "100100"
[138,] "136136" "104104" "138138" "100100"
[139,] "134134" "104104" "138137" "100100"
[140,] "134134" "104104" "140137" "100100"
[141,] "136134" "104104" "138137" "100100"
[142,] "136136" "104104" "140138" "100100"
[143,] "144134" "104104" "138137" "100100"
[144,] "134134" "104104" "140137" "100100"
[145,] "136134" "104104" "140138" "100100"
[146,] "142136" "9696"   "134134" "122122"
[147,] "142136" "9696"   "134134" "112100"
[148,] "136136" "9696"   "134134" "122106"
[149,] "142136" "9696"   "134134" "100100"
[150,] "142136" "9696"   "134134" "112100"
[151,] "136136" "13296"  "134134" "138136"
[152,] "142136" "9696"   "134134" "100100"
[153,] "142136" "9696"   "134134" "120108"</code></pre>
</div>
</div>
<ul>
<li>What we have now is a matrix with two alleles per column, but we are not done yet as we need to add samples information, the name of the loci, and transform everything in a dataframe. Before doing this we need to install and load another package that helps with string manipulations. The package is called <strong>stringr</strong> <span class="citation" data-cites="Wickham2023">(<a href="#/references" role="doc-biblioref" onclick="">Wickham, 2023</a>)</span></li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a></a><span class="fu">install.packages</span>(<span class="st">"stringr"</span>)</span>
<span id="cb42-2"><a></a><span class="fu">library</span>(stringr)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section class="slide level2">

<ul>
<li>We can now proceed with adding the names and transforming everything from a matrix to a dataframe</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a></a><span class="fu">rownames</span>(kestrel_df) <span class="ot">&lt;-</span> kestrel<span class="sc">$</span>ID</span>
<span id="cb43-2"><a></a><span class="fu">colnames</span>(kestrel_df) <span class="ot">&lt;-</span> <span class="fu">unlist</span>(<span class="fu">str_split</span>(<span class="fu">colnames</span>(kestrel)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)],</span>
<span id="cb43-3"><a></a>                                                <span class="st">"_"</span>))[<span class="fu">seq</span>(<span class="dv">1</span>, <span class="fu">length</span>(<span class="fu">unlist</span>(<span class="fu">str_split</span>(<span class="fu">colnames</span>(kestrel)[<span class="sc">-</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>)],</span>
<span id="cb43-4"><a></a>                                                                                     <span class="st">"_"</span>))), <span class="dv">4</span>)]</span>
<span id="cb43-5"><a></a>kestrel_df <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(kestrel_df)</span>
<span id="cb43-6"><a></a>kestrel_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>            MS1    MS2    MS3    MS4    MS5    MS6    MS7    MS8    MS9   MS10
Kest_1   110110 134134 210210   9797 136136 128128 121121 199199 140140 120120
Kest_2   108108   NANA 176176   9797   NANA   NANA   NANA   NANA   NANA   NANA
Kest_3   110108 108108 228222   9797 136136 128128 121121 203199 140140 120120
Kest_4   110108 108108 180180   9797 136136   NANA 121121   NANA 140140 116116
Kest_5   110108 108108 222210   9797 136136 128128 121121   NANA 140140 116116
Kest_6   108108   NANA   NANA   9797   NANA 128128 121121   NANA   NANA   NANA
Kest_7   108108 134134 216216   9797   NANA 128128 121121   NANA   NANA   NANA
Kest_8   108108 134134 210192   9797   NANA 128128 121121   NANA   NANA 120116
Kest_9   110108 136134 228216   9797 136136 128128 121121 203203 140140 120120
Kest_10  108108   NANA   NANA   9797 136136 128128 121121   NANA   NANA 116116
Kest_11  108108 136136   NANA   9797 138136 128128 121121   NANA 140140 116116
Kest_12  110108 136134 228222   9797 136136 128128   NANA 203203 140140 120116
Kest_13  108108 134134 252234   9797 136136 128128 121121   NANA 140140 120116
Kest_14  108108 136134 258222   9797 136136 128128 121121 207203 140140 116116
Kest_15  108108 136136 252234   9797 136136 128128 121121 203197 140140 120116
Kest_16  110108 134134 234228   9797 136136 128128 121121 203203 140140 120116
Kest_17  108108 136136 228222   9797 136136 128128 121121 203197 140140 116116
Kest_18  108108 136136 210210   9797 136136 128128 121121 207197 140140 120116
Kest_19  108108 134134 246228   9797 136136 128128 121121 207199 140140 116116
Kest_20  110108 134134 240240   9797 136136 128128 121121 203203 140140 116116
Kest_21  110108 136136 246222   9797 136136 128128 121121 197197 140140 120116
Kest_22  110108 136134 198192   9797 136136 128128 121121 197197 140140 116116
Kest_23  108108   NANA   NANA   9797 136136   NANA 121121   NANA   NANA   NANA
Kest_24  110108   NANA   NANA   NANA   NANA   NANA 121121   NANA   NANA   NANA
Kest_25  110108 134134 234198   9797 136136 128128 121121 203203 140140   NANA
Kest_26  110108 134134 222216   9797   NANA 128128 121121   NANA 140140   NANA
Kest_27  108108 136134 222222   9797 136136 128128 121121 203203 140140 116116
Kest_28  110110 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_29  108108 136136 228222   9797 136136 128128 121121 203203 140140 116116
Kest_30  108108 136134 210210   9797 136136 128128 121121 203203 140140 116116
Kest_31  108108 134134 222210   9797 136136 128128 121121 203203 140140 116116
Kest_32  108108 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_33  110108 136134 210210   9797 136136 128128 121121 203203 140140 116116
Kest_34  110108 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_35  110108 136136 222210   9797 136136 128128 121121 203203 140140 116116
Kest_36  108108 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_37  108108 136136 222210   9797 136136 128128 121121 203203 140140 116116
Kest_38  108108 136134 210210   9797 136136 128128 121121 203203 140140 116116
Kest_39  110108 136134 210210   9797 136136 128128 121121 203203 140140 116116
Kest_40  108108 136134 228210   9797 136136 128128 121121 203203 140140 116116
Kest_41  110108 136136 228210   9797 136136 128128 121121 203203 140140 116116
Kest_42  108108 136134 228210   9797 136136 128128 121121 203203 140140 116116
Kest_43  108108 136134 222210   9797 136136 128128 121121 203203 140140 116116
Kest_44  110108 136134 222210   9797 136136 128128 121121 203203 140140 116116
Kest_45  110108 136136 228228   9797 136136 128128 121121 203203 140140 116116
Kest_46  108108 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_47  110108 136136 228210   9797 136136 128128 121121 203203 140140 116116
Kest_48  108108 136134 210210   9797 136136 128128 121121 203203 140140 116116
Kest_49  110108 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_50  108108 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_51  110108 136134 210210   9797 136136 128128 121121 203203 140140 116116
Kest_52  108108 136134 210210   9797 136136 128128 121121 203203 140140 116116
Kest_53  110110 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_54  108108 136134 210210   9797 136136 128128 121121 203203 140140 116116
Kest_55  108108 136134 228210   9797 136136 128128 121121 203203 140140 116116
Kest_56  110110 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_57  108108 136134 210210   9797 136136 128128 121121 203203 140140 116116
Kest_58  108108 136136 228222   9797 136136 128128 121121 203203 140140 116116
Kest_59  108108 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_60  108108 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_61  110110 136136 228210   9797 136136 128128 121121 203203 140140 116116
Kest_62  110110 136136 228228   9797 136136 128128 121121 203203 140140 116116
Kest_63  108108 136134 222222   9797 136136 128128 121121 203203 140140 116116
Kest_64  108108 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_65  110108 136136 222210   9797 136136 128128 121121 203203 140140 116116
Kest_66  108108 134134 228210   9797 136136 128128 121121 203203 140140 116116
Kest_67  110108 136134 222210   9797 136136 128128 121121 203203 140140 116116
Kest_68  108108 136134 222210   9797 136136 128128 121121 203203 140140 116116
Kest_69  110108 136134 228210   9797 136136 128128 121121 203203 140140 116116
Kest_70  110110 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_71  108108 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_72  110108 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_73  110108 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_74  110108 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_75  110108 136134 210210   9797 136136 128128 121121 203203 140140 116116
Kest_76  108108 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_77  110108 136136 222210   9797 136136 128128 121121 203203 140140 116116
Kest_78  108108 136134 210210   9797 136136 128128 121121 203203 140140 116116
Kest_79  110108 136134 210210   9797 136136 128128 121121 203203 140140 116116
Kest_80  110108 136134 222210   9797 136136 128128 121121 203203 140140 116116
Kest_81  110108 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_82  110108 136134 210210   9797 136136 128128 121121 203203 140140 116116
Kest_83  110110 136134 210210   9797 136136 128128 121121 203203 140140 116116
Kest_84  108108 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_85  110108 136134 210210   9797 136136 128128 121121 203203 140140 116116
Kest_86  110108 136136 222210   9797 136136 128128 121121 203203 140140 116116
Kest_87  110110 136134 210210   9797 136136 128128 121121 203203 140140 116116
Kest_88  110108 136134 228210   9797 136136 128128 121121 203203 140140 116116
Kest_89  110108 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_90  108108 136136 222210   9797 136136 128128 121121 203203 140140 116116
Kest_91  108108 136134 222222   9797 136136 128128 121121 203203 140140 116116
Kest_92  110110 136136 228222   9797 136136 128128 121121 203203 140140 116116
Kest_93  108108 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_94  110108 136136 222210   9797 136136 128128 121121 203203 140140 116116
Kest_95  108108 136136 210210   9797 136136 128128 121121 203203 140140 116116
Kest_96  110110 136136 228210   9797 136136 128128 121121 203203 140140 116116
Kest_97  108108 136134 222210   9797 136136 128128 121121 203203 140140 116116
Kest_98  108108 136134 222210   9797 136136 128128 121121 203203 140140 116116
Kest_99  110108 136136 222210   9797 136136 128128 121121 203203 140140 116116
Kest_100 108108 136136 222210   9797 136136 128128 121121 203203 140140 116116
Kest_101 110108 134134 228210   9797 136136 128128 121121 203203 140140 116116
Kest_102 106106 134134 174174 101101 136136 132132 121121 205205 136136 116104
Kest_103 106106 134134 174168 101101 136136 132132 121121 205205 136136 120104
Kest_104 106106 134134 174174 101101 136136 132132 121121 205205 136136 120120
Kest_105 106106 134134 174174 101101 136136 132132 121121 205205 136136 120120
Kest_106 108106 134134 264216 101101 136136 126132 121121 189189 136136 128120
Kest_107 106106 138126 258234   9995 136136 124124 123121 225225 140136 132124
Kest_108 106106 132126 246228   9999 136136 124124 123121 195195 142140 132128
Kest_109 108106 134132 306294   9999 136136 124124 121119 225221 140140 140128
Kest_110 110106 126126 276264   9999 136136 124124 123121 223199 140140 132124
Kest_111 106106 132128 300246   9997 136136 124124 121121 197197 144140 128124
Kest_112 106106 126126 264222   9997 136136 124124 123121 197197 146140 124124
Kest_113 106106 134126 264252   9995 136136 124124 123121 223197 140140 128128
Kest_114 106106 132126 276258   9995 136134 124124 121119 253253 146140 128124
Kest_115 108100 138126 270270   9995 136136 124124 121119 223223 140140 128128
Kest_116 106106 126126 300288   9995 136136 124124 123121 243197 144140 128124
Kest_117 112102 134126 252246   9997 136136 127123 125125 201201 144134 132124
Kest_118 112104 132126 246246   9999 136136 129124 125121 197197 134134 136124
Kest_119 104102 126126 276246   9997 138136 127123 123123 217201 140136 128124
Kest_120 108104 126126 276198   9797 136136 127121 125121 223197 136136 124124
Kest_121 118110 134126 276228   9999 136136 125123 125121 211211 134132 124124
Kest_122 106102 132126 276264   9997 140136 123123 123121 213205 134134 128124
Kest_123 108106 134126 258258   9797 140136 129123 123121 197197 132132 128128
Kest_124 110104 132126 264210 105101 136136 129123 125121 205191 138134 124124
Kest_125 110106 132126 276228   9999 140138 123123 123121 223223 138132 124124
Kest_126 110110 132126 276246   9997 140136 129127 121121 211211 138136 116116
Kest_127 108104 126126 282198  10599 136136 131131 123123 229203 142136 136132
Kest_128 110104 132132 264264   9999 140136 127126 119119 211211 136134 128124
Kest_129 110110 126126 258221   9999 140140 126124 121121 211211 136134 128124
Kest_130 106102 134134 258221   9999 136136 125123 121119 203203 144134 124124
Kest_131 112110 132132 228210   9797 140136 126125 121121 211203 136136 140124
Kest_132 110104 134126 360258   9797 140136 126125 121121 211211 142136 128124
Kest_133 110104 132132 312216   9997 140136 126126 121121 211211 146134 128124
Kest_134 110104 132126 276228   9999 140136 127127 127123 211203 136134 132128
Kest_135 110104 134126 258221   9997 140140 126126 121119 213207 136136 134124
Kest_136 110110 134134 270234  10197 138136 127127 127123 281277 134134 104104
Kest_137 110108 134134 282221   9797 138138 128128 127127 281273 140136 104104
Kest_138 110110 134134 300222   9797 136136 128128 129127 253199 136136 104104
Kest_139 108108 134134 312276   9797 142138 125125 131123 189189 134134 104104
Kest_140 110108 134134 300221   9797 136136 127115 123123 189189 134134 104104
Kest_141 110106 134134 306226   9797 144136 128128 127127 287253 136134 104104
Kest_142 108108 134134 270222   9797 136132 127125 127123 267253 136136 104104
Kest_143 110108 134134 240234   9797 138138 127127 127123 277189 144134 104104
Kest_144 110110 134134 300276   9797 132132 128128 125123 291265 134134 104104
Kest_145 112108 134134 258234   9797 136136 128128 127123 213213 136134 104104
Kest_146 108106 134134 267267  11191 132124 137133 123123 225189 142136   9696
Kest_147 106102 132132 276270  11197 144140 135131 123121 191189 142136   9696
Kest_148 106106 134134 282252  11197 138132 135132 127123 203187 136136   9696
Kest_149 106106 134134 261225   9191 132132 127123 123121 199199 142136   9696
Kest_150 106100 132128 306294  11197 140138 131129 127123 199189 142136   9696
Kest_151  10894 134134 288288   9791 140138 137133 131123 225187 136136  13296
Kest_152 110106 134126 324246   9797 138138 131125 131123 199191 142136   9696
Kest_153 108108 128128 300300  11197 140130 135129 127123 225201 142136   9696
           MS11   MS12
Kest_1     NANA   NANA
Kest_2     NANA   NANA
Kest_3     NANA   NANA
Kest_4     NANA   NANA
Kest_5     NANA   NANA
Kest_6     NANA   NANA
Kest_7     NANA   NANA
Kest_8     NANA   NANA
Kest_9     NANA   NANA
Kest_10    NANA   NANA
Kest_11    NANA   NANA
Kest_12    NANA   NANA
Kest_13    NANA   NANA
Kest_14    NANA   NANA
Kest_15    NANA   NANA
Kest_16    NANA   NANA
Kest_17    NANA   NANA
Kest_18    NANA   NANA
Kest_19    NANA   NANA
Kest_20    NANA   NANA
Kest_21    NANA   NANA
Kest_22    NANA   NANA
Kest_23    NANA   NANA
Kest_24    NANA   NANA
Kest_25    NANA   NANA
Kest_26    NANA   NANA
Kest_27  136136 112112
Kest_28  136136 112112
Kest_29  136136 112112
Kest_30  136136 112112
Kest_31  136136 112112
Kest_32  136136 112112
Kest_33  136136 112112
Kest_34  136136 112112
Kest_35  136136 112112
Kest_36  136136 112112
Kest_37  136136 112112
Kest_38  136136 112112
Kest_39  136136 112112
Kest_40  136136 112112
Kest_41  136136 112112
Kest_42  136136 112112
Kest_43  136136 112112
Kest_44  136136 112112
Kest_45  136136 112112
Kest_46  136136 112112
Kest_47  136136 112112
Kest_48  136136 112112
Kest_49  136136 112112
Kest_50  136136 112112
Kest_51  136136 112112
Kest_52  136136 112112
Kest_53  136136 112112
Kest_54  136136 112112
Kest_55  136136 112112
Kest_56  136136 112112
Kest_57  136136 112112
Kest_58  136136 112112
Kest_59  136136 112112
Kest_60  136136 112112
Kest_61  136136 112112
Kest_62  136136 112112
Kest_63  136136 112112
Kest_64  136136 112112
Kest_65  136136 112112
Kest_66  136136 112112
Kest_67  136136 112112
Kest_68  136136 112112
Kest_69  136136 112112
Kest_70  136136 112112
Kest_71  136136 112112
Kest_72  136136 112112
Kest_73  136136 112112
Kest_74  136136 112112
Kest_75  136136 112112
Kest_76  136136 112112
Kest_77  136136 112112
Kest_78  136136 112112
Kest_79  136136 112112
Kest_80  136136 112112
Kest_81  136136 112112
Kest_82  136136 112112
Kest_83  136136 112112
Kest_84  136136 112112
Kest_85  136136 112112
Kest_86  136136 112112
Kest_87  136136 112112
Kest_88  136136 112112
Kest_89  136136 112112
Kest_90  136136 112112
Kest_91  136136 112112
Kest_92  136136 112112
Kest_93  136136 112112
Kest_94  136136 112112
Kest_95  136136 112112
Kest_96  136136 112112
Kest_97  136136 112112
Kest_98  136136 112112
Kest_99  136136 112112
Kest_100 136136 112112
Kest_101 136136 112112
Kest_102 138138 100100
Kest_103 138138 100100
Kest_104 138138 100100
Kest_105 138138 100100
Kest_106 138138 100100
Kest_107 142142 102102
Kest_108 142138 102100
Kest_109 142142 100100
Kest_110 140137 114114
Kest_111 138136 100100
Kest_112 142140 114114
Kest_113 142142 122116
Kest_114 142136 102102
Kest_115 142136 126116
Kest_116 138136 100100
Kest_117 138136 109100
Kest_118 138134 110100
Kest_119 138138 104100
Kest_120 140134 109102
Kest_121 138138 128128
Kest_122 142138 102100
Kest_123 136136 100100
Kest_124 138138 100100
Kest_125 136136 114100
Kest_126 138138 132132
Kest_127 138138 100100
Kest_128 138136 102102
Kest_129 138138 109100
Kest_130 138138 109100
Kest_131 140140 106106
Kest_132 138136 114100
Kest_133 140138 106106
Kest_134 138136 132102
Kest_135 138138 106106
Kest_136 138132 100100
Kest_137 138138 100100
Kest_138 138138 100100
Kest_139 138137 100100
Kest_140 140137 100100
Kest_141 138137 100100
Kest_142 140138 100100
Kest_143 138137 100100
Kest_144 140137 100100
Kest_145 140138 100100
Kest_146 134134 122122
Kest_147 134134 112100
Kest_148 134134 122106
Kest_149 134134 100100
Kest_150 134134 112100
Kest_151 134134 138136
Kest_152 134134 100100
Kest_153 134134 120108</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<ul>
<li>We add the information about the sample provenience and we then simplify the information re the missing data</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a></a>kestrel_df <span class="ot">&lt;-</span> <span class="fu">cbind</span>(kestrel<span class="sc">$</span>Info, kestrel_df)</span>
<span id="cb45-2"><a></a>kestrel_df[kestrel_df <span class="sc">==</span> <span class="st">"NANA"</span>] <span class="ot">&lt;-</span> <span class="st">"NA"</span></span>
<span id="cb45-3"><a></a>kestrel_df[,<span class="sc">-</span><span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">sapply</span>(kestrel_df[,<span class="sc">-</span><span class="dv">1</span>], as.numeric)</span>
<span id="cb45-4"><a></a>kestrel_df</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>                  kestrel$Info    MS1    MS2    MS3    MS4    MS5    MS6    MS7
Kest_1             Museum Skin 110110 134134 210210   9797 136136 128128 121121
Kest_2             Museum Skin 108108     NA 176176   9797     NA     NA     NA
Kest_3             Museum Skin 110108 108108 228222   9797 136136 128128 121121
Kest_4             Museum Skin 110108 108108 180180   9797 136136     NA 121121
Kest_5             Museum Skin 110108 108108 222210   9797 136136 128128 121121
Kest_6             Museum Skin 108108     NA     NA   9797     NA 128128 121121
Kest_7             Museum Skin 108108 134134 216216   9797     NA 128128 121121
Kest_8             Museum Skin 108108 134134 210192   9797     NA 128128 121121
Kest_9             Museum Skin 110108 136134 228216   9797 136136 128128 121121
Kest_10            Museum Skin 108108     NA     NA   9797 136136 128128 121121
Kest_11            Museum Skin 108108 136136     NA   9797 138136 128128 121121
Kest_12            Museum Skin 110108 136134 228222   9797 136136 128128     NA
Kest_13            Museum Skin 108108 134134 252234   9797 136136 128128 121121
Kest_14            Museum Skin 108108 136134 258222   9797 136136 128128 121121
Kest_15            Museum Skin 108108 136136 252234   9797 136136 128128 121121
Kest_16            Museum Skin 110108 134134 234228   9797 136136 128128 121121
Kest_17            Museum Skin 108108 136136 228222   9797 136136 128128 121121
Kest_18            Museum Skin 108108 136136 210210   9797 136136 128128 121121
Kest_19            Museum Skin 108108 134134 246228   9797 136136 128128 121121
Kest_20            Museum Skin 110108 134134 240240   9797 136136 128128 121121
Kest_21            Museum Skin 110108 136136 246222   9797 136136 128128 121121
Kest_22            Museum Skin 110108 136134 198192   9797 136136 128128 121121
Kest_23            Museum Skin 108108     NA     NA   9797 136136     NA 121121
Kest_24            Museum Skin 110108     NA     NA     NA     NA     NA 121121
Kest_25            Museum Skin 110108 134134 234198   9797 136136 128128 121121
Kest_26            Museum Skin 110108 134134 222216   9797     NA 128128 121121
Kest_27              Mauritius 108108 136134 222222   9797 136136 128128 121121
Kest_28              Mauritius 110110 136136 210210   9797 136136 128128 121121
Kest_29              Mauritius 108108 136136 228222   9797 136136 128128 121121
Kest_30              Mauritius 108108 136134 210210   9797 136136 128128 121121
Kest_31              Mauritius 108108 134134 222210   9797 136136 128128 121121
Kest_32              Mauritius 108108 136136 210210   9797 136136 128128 121121
Kest_33              Mauritius 110108 136134 210210   9797 136136 128128 121121
Kest_34              Mauritius 110108 136136 210210   9797 136136 128128 121121
Kest_35              Mauritius 110108 136136 222210   9797 136136 128128 121121
Kest_36              Mauritius 108108 136136 210210   9797 136136 128128 121121
Kest_37              Mauritius 108108 136136 222210   9797 136136 128128 121121
Kest_38              Mauritius 108108 136134 210210   9797 136136 128128 121121
Kest_39              Mauritius 110108 136134 210210   9797 136136 128128 121121
Kest_40              Mauritius 108108 136134 228210   9797 136136 128128 121121
Kest_41              Mauritius 110108 136136 228210   9797 136136 128128 121121
Kest_42              Mauritius 108108 136134 228210   9797 136136 128128 121121
Kest_43              Mauritius 108108 136134 222210   9797 136136 128128 121121
Kest_44              Mauritius 110108 136134 222210   9797 136136 128128 121121
Kest_45              Mauritius 110108 136136 228228   9797 136136 128128 121121
Kest_46              Mauritius 108108 136136 210210   9797 136136 128128 121121
Kest_47              Mauritius 110108 136136 228210   9797 136136 128128 121121
Kest_48              Mauritius 108108 136134 210210   9797 136136 128128 121121
Kest_49              Mauritius 110108 136136 210210   9797 136136 128128 121121
Kest_50              Mauritius 108108 136136 210210   9797 136136 128128 121121
Kest_51              Mauritius 110108 136134 210210   9797 136136 128128 121121
Kest_52              Mauritius 108108 136134 210210   9797 136136 128128 121121
Kest_53              Mauritius 110110 136136 210210   9797 136136 128128 121121
Kest_54              Mauritius 108108 136134 210210   9797 136136 128128 121121
Kest_55              Mauritius 108108 136134 228210   9797 136136 128128 121121
Kest_56              Mauritius 110110 136136 210210   9797 136136 128128 121121
Kest_57              Mauritius 108108 136134 210210   9797 136136 128128 121121
Kest_58              Mauritius 108108 136136 228222   9797 136136 128128 121121
Kest_59              Mauritius 108108 136136 210210   9797 136136 128128 121121
Kest_60              Mauritius 108108 136136 210210   9797 136136 128128 121121
Kest_61              Mauritius 110110 136136 228210   9797 136136 128128 121121
Kest_62              Mauritius 110110 136136 228228   9797 136136 128128 121121
Kest_63              Mauritius 108108 136134 222222   9797 136136 128128 121121
Kest_64              Mauritius 108108 136136 210210   9797 136136 128128 121121
Kest_65              Mauritius 110108 136136 222210   9797 136136 128128 121121
Kest_66              Mauritius 108108 134134 228210   9797 136136 128128 121121
Kest_67              Mauritius 110108 136134 222210   9797 136136 128128 121121
Kest_68              Mauritius 108108 136134 222210   9797 136136 128128 121121
Kest_69              Mauritius 110108 136134 228210   9797 136136 128128 121121
Kest_70              Mauritius 110110 136136 210210   9797 136136 128128 121121
Kest_71              Mauritius 108108 136136 210210   9797 136136 128128 121121
Kest_72              Mauritius 110108 136136 210210   9797 136136 128128 121121
Kest_73              Mauritius 110108 136136 210210   9797 136136 128128 121121
Kest_74              Mauritius 110108 136136 210210   9797 136136 128128 121121
Kest_75              Mauritius 110108 136134 210210   9797 136136 128128 121121
Kest_76              Mauritius 108108 136136 210210   9797 136136 128128 121121
Kest_77              Mauritius 110108 136136 222210   9797 136136 128128 121121
Kest_78              Mauritius 108108 136134 210210   9797 136136 128128 121121
Kest_79              Mauritius 110108 136134 210210   9797 136136 128128 121121
Kest_80              Mauritius 110108 136134 222210   9797 136136 128128 121121
Kest_81              Mauritius 110108 136136 210210   9797 136136 128128 121121
Kest_82              Mauritius 110108 136134 210210   9797 136136 128128 121121
Kest_83              Mauritius 110110 136134 210210   9797 136136 128128 121121
Kest_84              Mauritius 108108 136136 210210   9797 136136 128128 121121
Kest_85              Mauritius 110108 136134 210210   9797 136136 128128 121121
Kest_86              Mauritius 110108 136136 222210   9797 136136 128128 121121
Kest_87              Mauritius 110110 136134 210210   9797 136136 128128 121121
Kest_88              Mauritius 110108 136134 228210   9797 136136 128128 121121
Kest_89              Mauritius 110108 136136 210210   9797 136136 128128 121121
Kest_90              Mauritius 108108 136136 222210   9797 136136 128128 121121
Kest_91              Mauritius 108108 136134 222222   9797 136136 128128 121121
Kest_92              Mauritius 110110 136136 228222   9797 136136 128128 121121
Kest_93              Mauritius 108108 136136 210210   9797 136136 128128 121121
Kest_94              Mauritius 110108 136136 222210   9797 136136 128128 121121
Kest_95              Mauritius 108108 136136 210210   9797 136136 128128 121121
Kest_96              Mauritius 110110 136136 228210   9797 136136 128128 121121
Kest_97              Mauritius 108108 136134 222210   9797 136136 128128 121121
Kest_98              Mauritius 108108 136134 222210   9797 136136 128128 121121
Kest_99              Mauritius 110108 136136 222210   9797 136136 128128 121121
Kest_100             Mauritius 108108 136136 222210   9797 136136 128128 121121
Kest_101             Mauritius 110108 134134 228210   9797 136136 128128 121121
Kest_102    Seychelles Kestrel 106106 134134 174174 101101 136136 132132 121121
Kest_103    Seychelles Kestrel 106106 134134 174168 101101 136136 132132 121121
Kest_104    Seychelles Kestrel 106106 134134 174174 101101 136136 132132 121121
Kest_105    Seychelles Kestrel 106106 134134 174174 101101 136136 132132 121121
Kest_106    Madagascan Kestrel 108106 134134 264216 101101 136136 126132 121121
Kest_107       SA Rock Kestrel 106106 138126 258234   9995 136136 124124 123121
Kest_108       SA Rock Kestrel 106106 132126 246228   9999 136136 124124 123121
Kest_109       SA Rock Kestrel 108106 134132 306294   9999 136136 124124 121119
Kest_110       SA Rock Kestrel 110106 126126 276264   9999 136136 124124 123121
Kest_111       SA Rock Kestrel 106106 132128 300246   9997 136136 124124 121121
Kest_112       SA Rock Kestrel 106106 126126 264222   9997 136136 124124 123121
Kest_113       SA Rock Kestrel 106106 134126 264252   9995 136136 124124 123121
Kest_114       SA Rock Kestrel 106106 132126 276258   9995 136134 124124 121119
Kest_115       SA Rock Kestrel 108100 138126 270270   9995 136136 124124 121119
Kest_116       SA Rock Kestrel 106106 126126 300288   9995 136136 124124 123121
Kest_117      European Kestrel 112102 134126 252246   9997 136136 127123 125125
Kest_118      European Kestrel 112104 132126 246246   9999 136136 129124 125121
Kest_119      European Kestrel 104102 126126 276246   9997 138136 127123 123123
Kest_120      European Kestrel 108104 126126 276198   9797 136136 127121 125121
Kest_121      European Kestrel 118110 134126 276228   9999 136136 125123 125121
Kest_122      European Kestrel 106102 132126 276264   9997 140136 123123 123121
Kest_123      European Kestrel 108106 134126 258258   9797 140136 129123 123121
Kest_124      European Kestrel 110104 132126 264210 105101 136136 129123 125121
Kest_125      European Kestrel 110106 132126 276228   9999 140138 123123 123121
Kest_126      European Kestrel 110110 132126 276246   9997 140136 129127 121121
Kest_127               Kestrel 108104 126126 282198  10599 136136 131131 123123
Kest_128 Canary Island Kestrel 110104 132132 264264   9999 140136 127126 119119
Kest_129 Canary Island Kestrel 110110 126126 258221   9999 140140 126124 121121
Kest_130 Canary Island Kestrel 106102 134134 258221   9999 136136 125123 121119
Kest_131 Canary Island Kestrel 112110 132132 228210   9797 140136 126125 121121
Kest_132 Canary Island Kestrel 110104 134126 360258   9797 140136 126125 121121
Kest_133 Canary Island Kestrel 110104 132132 312216   9997 140136 126126 121121
Kest_134 Canary Island Kestrel 110104 132126 276228   9999 140136 127127 127123
Kest_135 Canary Island Kestrel 110104 134126 258221   9997 140140 126126 121119
Kest_136       Greater Kestrel 110110 134134 270234  10197 138136 127127 127123
Kest_137       Greater Kestrel 110108 134134 282221   9797 138138 128128 127127
Kest_138       Greater Kestrel 110110 134134 300222   9797 136136 128128 129127
Kest_139       Greater Kestrel 108108 134134 312276   9797 142138 125125 131123
Kest_140       Greater Kestrel 110108 134134 300221   9797 136136 127115 123123
Kest_141       Greater Kestrel 110106 134134 306226   9797 144136 128128 127127
Kest_142       Greater Kestrel 108108 134134 270222   9797 136132 127125 127123
Kest_143       Greater Kestrel 110108 134134 240234   9797 138138 127127 127123
Kest_144       Greater Kestrel 110110 134134 300276   9797 132132 128128 125123
Kest_145       Greater Kestrel 112108 134134 258234   9797 136136 128128 127123
Kest_146        Lesser Kestrel 108106 134134 267267  11191 132124 137133 123123
Kest_147        Lesser Kestrel 106102 132132 276270  11197 144140 135131 123121
Kest_148        Lesser Kestrel 106106 134134 282252  11197 138132 135132 127123
Kest_149        Lesser Kestrel 106106 134134 261225   9191 132132 127123 123121
Kest_150        Lesser Kestrel 106100 132128 306294  11197 140138 131129 127123
Kest_151        Lesser Kestrel  10894 134134 288288   9791 140138 137133 131123
Kest_152        Lesser Kestrel 110106 134126 324246   9797 138138 131125 131123
Kest_153        Lesser Kestrel 108108 128128 300300  11197 140130 135129 127123
            MS8    MS9   MS10   MS11   MS12
Kest_1   199199 140140 120120     NA     NA
Kest_2       NA     NA     NA     NA     NA
Kest_3   203199 140140 120120     NA     NA
Kest_4       NA 140140 116116     NA     NA
Kest_5       NA 140140 116116     NA     NA
Kest_6       NA     NA     NA     NA     NA
Kest_7       NA     NA     NA     NA     NA
Kest_8       NA     NA 120116     NA     NA
Kest_9   203203 140140 120120     NA     NA
Kest_10      NA     NA 116116     NA     NA
Kest_11      NA 140140 116116     NA     NA
Kest_12  203203 140140 120116     NA     NA
Kest_13      NA 140140 120116     NA     NA
Kest_14  207203 140140 116116     NA     NA
Kest_15  203197 140140 120116     NA     NA
Kest_16  203203 140140 120116     NA     NA
Kest_17  203197 140140 116116     NA     NA
Kest_18  207197 140140 120116     NA     NA
Kest_19  207199 140140 116116     NA     NA
Kest_20  203203 140140 116116     NA     NA
Kest_21  197197 140140 120116     NA     NA
Kest_22  197197 140140 116116     NA     NA
Kest_23      NA     NA     NA     NA     NA
Kest_24      NA     NA     NA     NA     NA
Kest_25  203203 140140     NA     NA     NA
Kest_26      NA 140140     NA     NA     NA
Kest_27  203203 140140 116116 136136 112112
Kest_28  203203 140140 116116 136136 112112
Kest_29  203203 140140 116116 136136 112112
Kest_30  203203 140140 116116 136136 112112
Kest_31  203203 140140 116116 136136 112112
Kest_32  203203 140140 116116 136136 112112
Kest_33  203203 140140 116116 136136 112112
Kest_34  203203 140140 116116 136136 112112
Kest_35  203203 140140 116116 136136 112112
Kest_36  203203 140140 116116 136136 112112
Kest_37  203203 140140 116116 136136 112112
Kest_38  203203 140140 116116 136136 112112
Kest_39  203203 140140 116116 136136 112112
Kest_40  203203 140140 116116 136136 112112
Kest_41  203203 140140 116116 136136 112112
Kest_42  203203 140140 116116 136136 112112
Kest_43  203203 140140 116116 136136 112112
Kest_44  203203 140140 116116 136136 112112
Kest_45  203203 140140 116116 136136 112112
Kest_46  203203 140140 116116 136136 112112
Kest_47  203203 140140 116116 136136 112112
Kest_48  203203 140140 116116 136136 112112
Kest_49  203203 140140 116116 136136 112112
Kest_50  203203 140140 116116 136136 112112
Kest_51  203203 140140 116116 136136 112112
Kest_52  203203 140140 116116 136136 112112
Kest_53  203203 140140 116116 136136 112112
Kest_54  203203 140140 116116 136136 112112
Kest_55  203203 140140 116116 136136 112112
Kest_56  203203 140140 116116 136136 112112
Kest_57  203203 140140 116116 136136 112112
Kest_58  203203 140140 116116 136136 112112
Kest_59  203203 140140 116116 136136 112112
Kest_60  203203 140140 116116 136136 112112
Kest_61  203203 140140 116116 136136 112112
Kest_62  203203 140140 116116 136136 112112
Kest_63  203203 140140 116116 136136 112112
Kest_64  203203 140140 116116 136136 112112
Kest_65  203203 140140 116116 136136 112112
Kest_66  203203 140140 116116 136136 112112
Kest_67  203203 140140 116116 136136 112112
Kest_68  203203 140140 116116 136136 112112
Kest_69  203203 140140 116116 136136 112112
Kest_70  203203 140140 116116 136136 112112
Kest_71  203203 140140 116116 136136 112112
Kest_72  203203 140140 116116 136136 112112
Kest_73  203203 140140 116116 136136 112112
Kest_74  203203 140140 116116 136136 112112
Kest_75  203203 140140 116116 136136 112112
Kest_76  203203 140140 116116 136136 112112
Kest_77  203203 140140 116116 136136 112112
Kest_78  203203 140140 116116 136136 112112
Kest_79  203203 140140 116116 136136 112112
Kest_80  203203 140140 116116 136136 112112
Kest_81  203203 140140 116116 136136 112112
Kest_82  203203 140140 116116 136136 112112
Kest_83  203203 140140 116116 136136 112112
Kest_84  203203 140140 116116 136136 112112
Kest_85  203203 140140 116116 136136 112112
Kest_86  203203 140140 116116 136136 112112
Kest_87  203203 140140 116116 136136 112112
Kest_88  203203 140140 116116 136136 112112
Kest_89  203203 140140 116116 136136 112112
Kest_90  203203 140140 116116 136136 112112
Kest_91  203203 140140 116116 136136 112112
Kest_92  203203 140140 116116 136136 112112
Kest_93  203203 140140 116116 136136 112112
Kest_94  203203 140140 116116 136136 112112
Kest_95  203203 140140 116116 136136 112112
Kest_96  203203 140140 116116 136136 112112
Kest_97  203203 140140 116116 136136 112112
Kest_98  203203 140140 116116 136136 112112
Kest_99  203203 140140 116116 136136 112112
Kest_100 203203 140140 116116 136136 112112
Kest_101 203203 140140 116116 136136 112112
Kest_102 205205 136136 116104 138138 100100
Kest_103 205205 136136 120104 138138 100100
Kest_104 205205 136136 120120 138138 100100
Kest_105 205205 136136 120120 138138 100100
Kest_106 189189 136136 128120 138138 100100
Kest_107 225225 140136 132124 142142 102102
Kest_108 195195 142140 132128 142138 102100
Kest_109 225221 140140 140128 142142 100100
Kest_110 223199 140140 132124 140137 114114
Kest_111 197197 144140 128124 138136 100100
Kest_112 197197 146140 124124 142140 114114
Kest_113 223197 140140 128128 142142 122116
Kest_114 253253 146140 128124 142136 102102
Kest_115 223223 140140 128128 142136 126116
Kest_116 243197 144140 128124 138136 100100
Kest_117 201201 144134 132124 138136 109100
Kest_118 197197 134134 136124 138134 110100
Kest_119 217201 140136 128124 138138 104100
Kest_120 223197 136136 124124 140134 109102
Kest_121 211211 134132 124124 138138 128128
Kest_122 213205 134134 128124 142138 102100
Kest_123 197197 132132 128128 136136 100100
Kest_124 205191 138134 124124 138138 100100
Kest_125 223223 138132 124124 136136 114100
Kest_126 211211 138136 116116 138138 132132
Kest_127 229203 142136 136132 138138 100100
Kest_128 211211 136134 128124 138136 102102
Kest_129 211211 136134 128124 138138 109100
Kest_130 203203 144134 124124 138138 109100
Kest_131 211203 136136 140124 140140 106106
Kest_132 211211 142136 128124 138136 114100
Kest_133 211211 146134 128124 140138 106106
Kest_134 211203 136134 132128 138136 132102
Kest_135 213207 136136 134124 138138 106106
Kest_136 281277 134134 104104 138132 100100
Kest_137 281273 140136 104104 138138 100100
Kest_138 253199 136136 104104 138138 100100
Kest_139 189189 134134 104104 138137 100100
Kest_140 189189 134134 104104 140137 100100
Kest_141 287253 136134 104104 138137 100100
Kest_142 267253 136136 104104 140138 100100
Kest_143 277189 144134 104104 138137 100100
Kest_144 291265 134134 104104 140137 100100
Kest_145 213213 136134 104104 140138 100100
Kest_146 225189 142136   9696 134134 122122
Kest_147 191189 142136   9696 134134 112100
Kest_148 203187 136136   9696 134134 122106
Kest_149 199199 142136   9696 134134 100100
Kest_150 199189 142136   9696 134134 112100
Kest_151 225187 136136  13296 134134 138136
Kest_152 199191 142136   9696 134134 100100
Kest_153 225201 142136   9696 134134 120108</code></pre>
</div>
</div>
<ul>
<li>We can now start using functions from the hierfstat package</li>
</ul>
</section>
<section class="slide level2">

<ul>
<li>This first function counts the number of alleles by locus and in each population</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a></a><span class="fu">allele.count</span>(kestrel_df)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$MS1
     
x     Canary Island Kestrel European Kestrel Greater Kestrel Kestrel
  10                      0                0               0       0
  100                     0                0               0       0
  102                     1                3               0       0
  104                     5                4               0       1
  106                     1                3               1       0
  108                     0                2               8       1
  110                     8                5              10       0
  112                     1                2               1       0
  118                     0                1               0       0
  894                     0                0               0       0
     
x     Lesser Kestrel Madagascan Kestrel Mauritius Museum Skin SA Rock Kestrel
  10               1                  0         0           0               0
  100              1                  0         0           0               1
  102              1                  0         0           0               0
  104              0                  0         0           0               0
  106              8                  1         0           0              16
  108              3                  1       101          38               2
  110              1                  0        49          14               1
  112              0                  0         0           0               0
  118              0                  0         0           0               0
  894              1                  0         0           0               0
     
x     Seychelles Kestrel
  10                   0
  100                  0
  102                  0
  104                  0
  106                  8
  108                  0
  110                  0
  112                  0
  118                  0
  894                  0

$MS2
     
x     Canary Island Kestrel European Kestrel Greater Kestrel Kestrel
  108                     0                0               0       0
  126                     5               12               0       2
  128                     0                0               0       0
  132                     7                5               0       0
  134                     4                3              20       0
  136                     0                0               0       0
  138                     0                0               0       0
     
x     Lesser Kestrel Madagascan Kestrel Mauritius Museum Skin SA Rock Kestrel
  108              0                  0         0           6               0
  126              1                  0         0           0              11
  128              3                  0         0           0               1
  132              3                  0         0           0               4
  134              9                  2        37          22               2
  136              0                  0       113          14               0
  138              0                  0         0           0               2
     
x     Seychelles Kestrel
  108                  0
  126                  0
  128                  0
  132                  0
  134                  8
  136                  0
  138                  0

$MS3
     
x     Canary Island Kestrel European Kestrel Greater Kestrel Kestrel
  168                     0                0               0       0
  174                     0                0               0       0
  176                     0                0               0       0
  180                     0                0               0       0
  192                     0                0               0       0
  198                     0                1               0       1
  210                     1                1               0       0
  216                     1                0               0       0
  221                     3                0               2       0
  222                     0                0               2       0
  225                     0                0               0       0
  226                     0                0               1       0
  228                     2                2               0       0
  234                     0                0               3       0
  240                     0                0               1       0
  246                     0                5               0       0
  252                     0                1               0       0
  258                     4                2               1       0
  261                     0                0               0       0
  264                     2                2               0       0
  267                     0                0               0       0
  270                     0                0               2       0
  276                     1                6               2       0
  282                     0                0               1       1
  288                     0                0               0       0
  294                     0                0               0       0
  300                     0                0               3       0
  306                     0                0               1       0
  312                     1                0               1       0
  324                     0                0               0       0
  360                     1                0               0       0
     
x     Lesser Kestrel Madagascan Kestrel Mauritius Museum Skin SA Rock Kestrel
  168              0                  0         0           0               0
  174              0                  0         0           0               0
  176              0                  0         0           2               0
  180              0                  0         0           2               0
  192              0                  0         0           2               0
  198              0                  0         0           2               0
  210              0                  0       106           6               0
  216              0                  1         0           4               0
  221              0                  0         0           0               0
  222              0                  0        26           7               1
  225              1                  0         0           0               0
  226              0                  0         0           0               0
  228              0                  0        18           6               1
  234              0                  0         0           4               1
  240              0                  0         0           2               0
  246              1                  0         0           2               2
  252              1                  0         0           2               1
  258              0                  0         0           1               2
  261              1                  0         0           0               0
  264              0                  1         0           0               3
  267              2                  0         0           0               0
  270              1                  0         0           0               2
  276              1                  0         0           0               2
  282              1                  0         0           0               0
  288              2                  0         0           0               1
  294              1                  0         0           0               1
  300              2                  0         0           0               2
  306              1                  0         0           0               1
  312              0                  0         0           0               0
  324              1                  0         0           0               0
  360              0                  0         0           0               0
     
x     Seychelles Kestrel
  168                  1
  174                  7
  176                  0
  180                  0
  192                  0
  198                  0
  210                  0
  216                  0
  221                  0
  222                  0
  225                  0
  226                  0
  228                  0
  234                  0
  240                  0
  246                  0
  252                  0
  258                  0
  261                  0
  264                  0
  267                  0
  270                  0
  276                  0
  282                  0
  288                  0
  294                  0
  300                  0
  306                  0
  312                  0
  324                  0
  360                  0

$MS4
     
x     Canary Island Kestrel European Kestrel Greater Kestrel Kestrel
  9                       8                9               9       0
  10                      0                0               1       1
  11                      0                0               0       0
  101                     0                1               0       0
  105                     0                1               0       0
  191                     0                0               0       0
  197                     0                0               1       0
  599                     0                0               0       1
  791                     0                0               0       0
  797                     2                2               9       0
  995                     0                0               0       0
  997                     2                4               0       0
  999                     4                3               0       0
     
x     Lesser Kestrel Madagascan Kestrel Mauritius Museum Skin SA Rock Kestrel
  9                3                  0        75          25              10
  10               0                  0         0           0               0
  11               5                  0         0           0               0
  101              0                  2         0           0               0
  105              0                  0         0           0               0
  191              2                  0         0           0               0
  197              4                  0         0           0               0
  599              0                  0         0           0               0
  791              1                  0         0           0               0
  797              1                  0        75          25               0
  995              0                  0         0           0               5
  997              0                  0         0           0               2
  999              0                  0         0           0               3
     
x     Seychelles Kestrel
  9                    0
  10                   0
  11                   0
  101                  8
  105                  0
  191                  0
  197                  0
  599                  0
  791                  0
  797                  0
  995                  0
  997                  0
  999                  0

$MS5
     
x     Canary Island Kestrel European Kestrel Greater Kestrel Kestrel
  124                     0                0               0       0
  130                     0                0               0       0
  132                     0                0               3       0
  134                     0                0               0       0
  136                     7               14               9       2
  138                     0                2               6       0
  140                     9                4               0       0
  142                     0                0               1       0
  144                     0                0               1       0
     
x     Lesser Kestrel Madagascan Kestrel Mauritius Museum Skin SA Rock Kestrel
  124              1                  0         0           0               0
  130              1                  0         0           0               0
  132              4                  0         0           0               0
  134              0                  0         0           0               1
  136              0                  2       150          39              19
  138              5                  0         0           1               0
  140              4                  0         0           0               0
  142              0                  0         0           0               0
  144              1                  0         0           0               0
     
x     Seychelles Kestrel
  124                  0
  130                  0
  132                  0
  134                  0
  136                  8
  138                  0
  140                  0
  142                  0
  144                  0

$MS6
     
x     Canary Island Kestrel European Kestrel Greater Kestrel Kestrel
  115                     0                0               1       0
  121                     0                1               0       0
  123                     1                9               0       0
  124                     1                1               0       0
  125                     3                1               3       0
  126                     8                0               0       0
  127                     3                4               6       0
  128                     0                0              10       0
  129                     0                4               0       0
  131                     0                0               0       2
  132                     0                0               0       0
  133                     0                0               0       0
  135                     0                0               0       0
  137                     0                0               0       0
     
x     Lesser Kestrel Madagascan Kestrel Mauritius Museum Skin SA Rock Kestrel
  115              0                  0         0           0               0
  121              0                  0         0           0               0
  123              1                  0         0           0               0
  124              0                  0         0           0              20
  125              1                  0         0           0               0
  126              0                  1         0           0               0
  127              1                  0         0           0               0
  128              0                  0       150          44               0
  129              2                  0         0           0               0
  131              3                  0         0           0               0
  132              1                  1         0           0               0
  133              2                  0         0           0               0
  135              3                  0         0           0               0
  137              2                  0         0           0               0
     
x     Seychelles Kestrel
  115                  0
  121                  0
  123                  0
  124                  0
  125                  0
  126                  0
  127                  0
  128                  0
  129                  0
  131                  0
  132                  8
  133                  0
  135                  0
  137                  0

$MS7
     
x     Canary Island Kestrel European Kestrel Greater Kestrel Kestrel
  119                     4                0               0       0
  121                    10                9               0       0
  123                     1                5               8       2
  125                     0                6               1       0
  127                     1                0               9       0
  129                     0                0               1       0
  131                     0                0               1       0
     
x     Lesser Kestrel Madagascan Kestrel Mauritius Museum Skin SA Rock Kestrel
  119              0                  0         0           0               3
  121              2                  2       150          48              11
  123              9                  0         0           0               6
  125              0                  0         0           0               0
  127              3                  0         0           0               0
  129              0                  0         0           0               0
  131              2                  0         0           0               0
     
x     Seychelles Kestrel
  119                  0
  121                  8
  123                  0
  125                  0
  127                  0
  129                  0
  131                  0

$MS8
     
x     Canary Island Kestrel European Kestrel Greater Kestrel Kestrel
  187                     0                0               0       0
  189                     0                0               5       0
  191                     0                1               0       0
  195                     0                0               0       0
  197                     0                5               0       0
  199                     0                0               1       0
  201                     0                3               0       0
  203                     4                0               0       1
  205                     0                2               0       0
  207                     1                0               0       0
  211                    10                4               0       0
  213                     1                1               2       0
  217                     0                1               0       0
  221                     0                0               0       0
  223                     0                3               0       0
  225                     0                0               0       0
  229                     0                0               0       1
  243                     0                0               0       0
  253                     0                0               3       0
  265                     0                0               1       0
  267                     0                0               1       0
  273                     0                0               1       0
  277                     0                0               2       0
  281                     0                0               2       0
  287                     0                0               1       0
  291                     0                0               1       0
     
x     Lesser Kestrel Madagascan Kestrel Mauritius Museum Skin SA Rock Kestrel
  187              2                  0         0           0               0
  189              3                  2         0           0               0
  191              2                  0         0           0               0
  195              0                  0         0           0               2
  197              0                  0         0           7               6
  199              4                  0         0           4               1
  201              1                  0         0           0               0
  203              1                  0       150          14               0
  205              0                  0         0           0               0
  207              0                  0         0           3               0
  211              0                  0         0           0               0
  213              0                  0         0           0               0
  217              0                  0         0           0               0
  221              0                  0         0           0               1
  223              0                  0         0           0               4
  225              3                  0         0           0               3
  229              0                  0         0           0               0
  243              0                  0         0           0               1
  253              0                  0         0           0               2
  265              0                  0         0           0               0
  267              0                  0         0           0               0
  273              0                  0         0           0               0
  277              0                  0         0           0               0
  281              0                  0         0           0               0
  287              0                  0         0           0               0
  291              0                  0         0           0               0
     
x     Seychelles Kestrel
  187                  0
  189                  0
  191                  0
  195                  0
  197                  0
  199                  0
  201                  0
  203                  0
  205                  8
  207                  0
  211                  0
  213                  0
  217                  0
  221                  0
  223                  0
  225                  0
  229                  0
  243                  0
  253                  0
  265                  0
  267                  0
  273                  0
  277                  0
  281                  0
  287                  0
  291                  0

$MS9
     
x     Canary Island Kestrel European Kestrel Greater Kestrel Kestrel
  132                     0                4               0       0
  134                     5                7              11       0
  136                     8                4               7       1
  138                     0                3               0       0
  140                     0                1               1       0
  142                     1                0               0       1
  144                     1                1               1       0
  146                     1                0               0       0
     
x     Lesser Kestrel Madagascan Kestrel Mauritius Museum Skin SA Rock Kestrel
  132              0                  0         0           0               0
  134              0                  0         0           0               0
  136             10                  2         0           0               1
  138              0                  0         0           0               0
  140              0                  0       150          38              14
  142              6                  0         0           0               1
  144              0                  0         0           0               2
  146              0                  0         0           0               2
     
x     Seychelles Kestrel
  132                  0
  134                  0
  136                  8
  138                  0
  140                  0
  142                  0
  144                  0
  146                  0

$MS10
     
x     Canary Island Kestrel European Kestrel Greater Kestrel Kestrel
  9                       0                0               0       0
  13                      0                0               0       0
  104                     0                0              20       0
  116                     0                2               0       0
  120                     0                0               0       0
  124                     8               12               0       0
  128                     5                4               0       0
  132                     1                1               0       1
  134                     1                0               0       0
  136                     0                1               0       1
  140                     1                0               0       0
  296                     0                0               0       0
  696                     0                0               0       0
     
x     Lesser Kestrel Madagascan Kestrel Mauritius Museum Skin SA Rock Kestrel
  9                7                  0         0           0               0
  13               1                  0         0           0               0
  104              0                  0         0           0               0
  116              0                  0       150          25               0
  120              0                  1         0          13               0
  124              0                  0         0           0               7
  128              0                  1         0           0               9
  132              0                  0         0           0               3
  134              0                  0         0           0               0
  136              0                  0         0           0               0
  140              0                  0         0           0               1
  296              1                  0         0           0               0
  696              7                  0         0           0               0
     
x     Seychelles Kestrel
  9                    0
  13                   0
  104                  2
  116                  1
  120                  5
  124                  0
  128                  0
  132                  0
  134                  0
  136                  0
  140                  0
  296                  0
  696                  0

$MS11
     
x     Canary Island Kestrel European Kestrel Greater Kestrel Kestrel
  132                     0                0               1       0
  134                     0                2               0       0
  136                     3                5               0       0
  137                     0                0               5       0
  138                    10               11              10       2
  140                     3                1               4       0
  142                     0                1               0       0
     
x     Lesser Kestrel Madagascan Kestrel Mauritius Museum Skin SA Rock Kestrel
  132              0                  0         0           0               0
  134             16                  0         0           0               0
  136              0                  0       150           0               4
  137              0                  0         0           0               1
  138              0                  2         0           0               3
  140              0                  0         0           0               2
  142              0                  0         0           0              10
     
x     Seychelles Kestrel
  132                  0
  134                  0
  136                  0
  137                  0
  138                  8
  140                  0
  142                  0

$MS12
     
x     Canary Island Kestrel European Kestrel Greater Kestrel Kestrel
  100                     3                9              20       2
  102                     3                2               0       0
  104                     0                1               0       0
  106                     6                0               0       0
  108                     0                0               0       0
  109                     2                2               0       0
  110                     0                1               0       0
  112                     0                0               0       0
  114                     1                1               0       0
  116                     0                0               0       0
  120                     0                0               0       0
  122                     0                0               0       0
  126                     0                0               0       0
  128                     0                2               0       0
  132                     1                2               0       0
  136                     0                0               0       0
  138                     0                0               0       0
     
x     Lesser Kestrel Madagascan Kestrel Mauritius Museum Skin SA Rock Kestrel
  100              6                  2         0           0               7
  102              0                  0         0           0               5
  104              0                  0         0           0               0
  106              1                  0         0           0               0
  108              1                  0         0           0               0
  109              0                  0         0           0               0
  110              0                  0         0           0               0
  112              2                  0       150           0               0
  114              0                  0         0           0               4
  116              0                  0         0           0               2
  120              1                  0         0           0               0
  122              3                  0         0           0               1
  126              0                  0         0           0               1
  128              0                  0         0           0               0
  132              0                  0         0           0               0
  136              1                  0         0           0               0
  138              1                  0         0           0               0
     
x     Seychelles Kestrel
  100                  8
  102                  0
  104                  0
  106                  0
  108                  0
  109                  0
  110                  0
  112                  0
  114                  0
  116                  0
  120                  0
  122                  0
  126                  0
  128                  0
  132                  0
  136                  0
  138                  0</code></pre>
</div>
</div>
</section>
<section class="slide level2">

<ul>
<li>Examinate the output of the <em>allele.count()</em> function. What issues did you notice?</li>
</ul>
</section>
<section id="references" class="slide level2 smaller scrollable">
<h2>References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" data-line-spacing="2" role="list">
<div id="ref-Goudet2005" class="csl-entry" role="listitem">
Goudet, J. (2005). <a href="https://doi.org/10.1111/j.1471-8278.2004.00828.x"><span class="nocase">HIERFSTAT, a package for R to compute and test hierarchical F-statistics</span></a>. <em>Molecular Ecology Notes</em>, <em>5</em>(1), 184–186.
</div>
<div id="ref-Groombridge2000" class="csl-entry" role="listitem">
Groombridge, J. J., Jones, C. G., Bruford, M. W., &amp; Nichols, R. A. (2000). <a href="https://doi.org/10.1038/35001148"><span class="nocase">’Ghost’ alleles of the Mauritius kestrel.</span></a> <em>Nature</em>, <em>403</em>(6770), 616.
</div>
<div id="ref-Wickham2023" class="csl-entry" role="listitem">
Wickham, H. (2023). <em>Stringr: Simple, consistent wrappers for common string operations</em>. Retrieved from <a href="https://stringr.tidyverse.org">https://stringr.tidyverse.org</a>
</div>
</div>
</section>
    </div>
  <div class="quarto-auto-generated-content" style="display: none;">
<p><img src="../../figures/Tor-Vergata_logo_cmyk.png" class="slide-logo"></p>
<div class="footer footer-default">
<p><a href="https://giulianocolosimo.github.io/biologia_della_conservazione_24-25/">Biologia della conservazione 24/25 - Giuliano Colosimo, PhD</a></p>
</div>
</div></div>

  <script>window.backupDefine = window.define; window.define = undefined;</script>
  <script src="../../site_libs/revealjs/dist/reveal.js"></script>
  <!-- reveal.js plugins -->
  <script src="../../site_libs/revealjs/plugin/quarto-line-highlight/line-highlight.js"></script>
  <script src="../../site_libs/revealjs/plugin/pdf-export/pdfexport.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-menu/quarto-menu.js"></script>
  <script src="../../site_libs/revealjs/plugin/reveal-chalkboard/plugin.js"></script>
  <script src="../../site_libs/revealjs/plugin/quarto-support/support.js"></script>
  

  <script src="../../site_libs/revealjs/plugin/notes/notes.js"></script>
  <script src="../../site_libs/revealjs/plugin/search/search.js"></script>
  <script src="../../site_libs/revealjs/plugin/zoom/zoom.js"></script>
  <script src="../../site_libs/revealjs/plugin/math/math.js"></script>
  <script>window.define = window.backupDefine; window.backupDefine = undefined;</script>

  <script>

      // Full list of configuration options available at:
      // https://revealjs.com/config/
      Reveal.initialize({
'controlsAuto': true,
'previewLinksAuto': false,
'pdfSeparateFragments': false,
'autoAnimateEasing': "ease",
'autoAnimateDuration': 1,
'autoAnimateUnmatched': true,
'jumpToSlide': true,
'menu': {"side":"left","useTextContentForMissingTitles":true,"markers":false,"loadIcons":false,"custom":[{"title":"Tools","icon":"<i class=\"fas fa-gear\"></i>","content":"<ul class=\"slide-menu-items\">\n<li class=\"slide-tool-item active\" data-item=\"0\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.fullscreen(event)\"><kbd>f</kbd> Fullscreen</a></li>\n<li class=\"slide-tool-item\" data-item=\"1\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.speakerMode(event)\"><kbd>s</kbd> Speaker View</a></li>\n<li class=\"slide-tool-item\" data-item=\"2\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.overview(event)\"><kbd>o</kbd> Slide Overview</a></li>\n<li class=\"slide-tool-item\" data-item=\"3\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.togglePdfExport(event)\"><kbd>e</kbd> PDF Export Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"4\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleScrollView(event)\"><kbd>r</kbd> Scroll View Mode</a></li>\n<li class=\"slide-tool-item\" data-item=\"5\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleChalkboard(event)\"><kbd>b</kbd> Toggle Chalkboard</a></li>\n<li class=\"slide-tool-item\" data-item=\"6\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.toggleNotesCanvas(event)\"><kbd>c</kbd> Toggle Notes Canvas</a></li>\n<li class=\"slide-tool-item\" data-item=\"7\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.downloadDrawings(event)\"><kbd>d</kbd> Download Drawings</a></li>\n<li class=\"slide-tool-item\" data-item=\"8\"><a href=\"#\" onclick=\"RevealMenuToolHandlers.keyboardHelp(event)\"><kbd>?</kbd> Keyboard Help</a></li>\n</ul>"}],"openButton":true},
'chalkboard': {"buttons":true,"boardmarkerWidth":5},
'smaller': false,
 
        // Display controls in the bottom right corner
        controls: false,

        // Help the user learn the controls by providing hints, for example by
        // bouncing the down arrow when they first encounter a vertical slide
        controlsTutorial: false,

        // Determines where controls appear, "edges" or "bottom-right"
        controlsLayout: 'edges',

        // Visibility rule for backwards navigation arrows; "faded", "hidden"
        // or "visible"
        controlsBackArrows: 'faded',

        // Display a presentation progress bar
        progress: true,

        // Display the page number of the current slide
        slideNumber: 'c/t',

        // 'all', 'print', or 'speaker'
        showSlideNumber: 'all',

        // Add the current slide number to the URL hash so that reloading the
        // page/copying the URL will return you to the same slide
        hash: true,

        // Start with 1 for the hash rather than 0
        hashOneBasedIndex: false,

        // Flags if we should monitor the hash and change slides accordingly
        respondToHashChanges: true,

        // Push each slide change to the browser history
        history: true,

        // Enable keyboard shortcuts for navigation
        keyboard: true,

        // Enable the slide overview mode
        overview: true,

        // Disables the default reveal.js slide layout (scaling and centering)
        // so that you can use custom CSS layout
        disableLayout: false,

        // Vertical centering of slides
        center: false,

        // Enables touch navigation on devices with touch input
        touch: true,

        // Loop the presentation
        loop: false,

        // Change the presentation direction to be RTL
        rtl: false,

        // see https://revealjs.com/vertical-slides/#navigation-mode
        navigationMode: 'linear',

        // Randomizes the order of slides each time the presentation loads
        shuffle: false,

        // Turns fragments on and off globally
        fragments: true,

        // Flags whether to include the current fragment in the URL,
        // so that reloading brings you to the same fragment position
        fragmentInURL: false,

        // Flags if the presentation is running in an embedded mode,
        // i.e. contained within a limited portion of the screen
        embedded: false,

        // Flags if we should show a help overlay when the questionmark
        // key is pressed
        help: true,

        // Flags if it should be possible to pause the presentation (blackout)
        pause: true,

        // Flags if speaker notes should be visible to all viewers
        showNotes: false,

        // Global override for autoplaying embedded media (null/true/false)
        autoPlayMedia: null,

        // Global override for preloading lazy-loaded iframes (null/true/false)
        preloadIframes: null,

        // Number of milliseconds between automatically proceeding to the
        // next slide, disabled when set to 0, this value can be overwritten
        // by using a data-autoslide attribute on your slides
        autoSlide: 0,

        // Stop auto-sliding after user input
        autoSlideStoppable: true,

        // Use this method for navigation when auto-sliding
        autoSlideMethod: null,

        // Specify the average time in seconds that you think you will spend
        // presenting each slide. This is used to show a pacing timer in the
        // speaker view
        defaultTiming: null,

        // Enable slide navigation via mouse wheel
        mouseWheel: false,

        // The display mode that will be used to show slides
        display: 'block',

        // Hide cursor if inactive
        hideInactiveCursor: true,

        // Time before the cursor is hidden (in ms)
        hideCursorTime: 5000,

        // Opens links in an iframe preview overlay
        previewLinks: true,

        // Transition style (none/fade/slide/convex/concave/zoom)
        transition: 'fade',

        // Transition speed (default/fast/slow)
        transitionSpeed: 'default',

        // Transition style for full page slide backgrounds
        // (none/fade/slide/convex/concave/zoom)
        backgroundTransition: 'none',

        // Number of slides away from the current that are visible
        viewDistance: 3,

        // Number of slides away from the current that are visible on mobile
        // devices. It is advisable to set this to a lower number than
        // viewDistance in order to save resources.
        mobileViewDistance: 2,

        // The "normal" size of the presentation, aspect ratio will be preserved
        // when the presentation is scaled to fit different resolutions. Can be
        // specified using percentage units.
        width: 1600,

        height: 900,

        // Factor of the display size that should remain empty around the content
        margin: 0.1,

        math: {
          mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/MathJax.js',
          config: 'TeX-AMS_HTML-full',
          tex2jax: {
            inlineMath: [['\\(','\\)']],
            displayMath: [['\\[','\\]']],
            balanceBraces: true,
            processEscapes: false,
            processRefs: true,
            processEnvironments: true,
            preview: 'TeX',
            skipTags: ['script','noscript','style','textarea','pre','code'],
            ignoreClass: 'tex2jax_ignore',
            processClass: 'tex2jax_process'
          },
        },

        // reveal.js plugins
        plugins: [QuartoLineHighlight, PdfExport, RevealMenu, RevealChalkboard, QuartoSupport,

          RevealMath,
          RevealNotes,
          RevealSearch,
          RevealZoom
        ]
      });
    </script>
    
    <script>
      // htmlwidgets need to know to resize themselves when slides are shown/hidden.
      // Fire the "slideenter" event (handled by htmlwidgets.js) when the current
      // slide changes (different for each slide format).
      (function () {
        // dispatch for htmlwidgets
        function fireSlideEnter() {
          const event = window.document.createEvent("Event");
          event.initEvent("slideenter", true, true);
          window.document.dispatchEvent(event);
        }

        function fireSlideChanged(previousSlide, currentSlide) {
          fireSlideEnter();

          // dispatch for shiny
          if (window.jQuery) {
            if (previousSlide) {
              window.jQuery(previousSlide).trigger("hidden");
            }
            if (currentSlide) {
              window.jQuery(currentSlide).trigger("shown");
            }
          }
        }

        // hookup for slidy
        if (window.w3c_slidy) {
          window.w3c_slidy.add_observer(function (slide_num) {
            // slide_num starts at position 1
            fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);
          });
        }

      })();
    </script>

    <script id="quarto-html-after-body" type="application/javascript">
    window.document.addEventListener("DOMContentLoaded", function (event) {
      const toggleBodyColorMode = (bsSheetEl) => {
        const mode = bsSheetEl.getAttribute("data-mode");
        const bodyEl = window.document.querySelector("body");
        if (mode === "dark") {
          bodyEl.classList.add("quarto-dark");
          bodyEl.classList.remove("quarto-light");
        } else {
          bodyEl.classList.add("quarto-light");
          bodyEl.classList.remove("quarto-dark");
        }
      }
      const toggleBodyColorPrimary = () => {
        const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
        if (bsSheetEl) {
          toggleBodyColorMode(bsSheetEl);
        }
      }
      toggleBodyColorPrimary();  
      const tabsets =  window.document.querySelectorAll(".panel-tabset-tabby")
      tabsets.forEach(function(tabset) {
        const tabby = new Tabby('#' + tabset.id);
      });
      const isCodeAnnotation = (el) => {
        for (const clz of el.classList) {
          if (clz.startsWith('code-annotation-')) {                     
            return true;
          }
        }
        return false;
      }
      const onCopySuccess = function(e) {
        // button target
        const button = e.trigger;
        // don't keep focus
        button.blur();
        // flash "checked"
        button.classList.add('code-copy-button-checked');
        var currentTitle = button.getAttribute("title");
        button.setAttribute("title", "Copied!");
        let tooltip;
        if (window.bootstrap) {
          button.setAttribute("data-bs-toggle", "tooltip");
          button.setAttribute("data-bs-placement", "left");
          button.setAttribute("data-bs-title", "Copied!");
          tooltip = new bootstrap.Tooltip(button, 
            { trigger: "manual", 
              customClass: "code-copy-button-tooltip",
              offset: [0, -8]});
          tooltip.show();    
        }
        setTimeout(function() {
          if (tooltip) {
            tooltip.hide();
            button.removeAttribute("data-bs-title");
            button.removeAttribute("data-bs-toggle");
            button.removeAttribute("data-bs-placement");
          }
          button.setAttribute("title", currentTitle);
          button.classList.remove('code-copy-button-checked');
        }, 1000);
        // clear code selection
        e.clearSelection();
      }
      const getTextToCopy = function(trigger) {
          const codeEl = trigger.previousElementSibling.cloneNode(true);
          for (const childEl of codeEl.children) {
            if (isCodeAnnotation(childEl)) {
              childEl.remove();
            }
          }
          return codeEl.innerText;
      }
      const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
        text: getTextToCopy
      });
      clipboard.on('success', onCopySuccess);
      if (window.document.getElementById('quarto-embedded-source-code-modal')) {
        const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
          text: getTextToCopy,
          container: window.document.getElementById('quarto-embedded-source-code-modal')
        });
        clipboardModal.on('success', onCopySuccess);
      }
        var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
        var mailtoRegex = new RegExp(/^mailto:/);
          var filterRegex = new RegExp("https:\/\/giulianocolosimo\.github\.com");
        var isInternal = (href) => {
            return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
        }
        // Inspect non-navigation links and adorn them if external
     	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
        for (var i=0; i<links.length; i++) {
          const link = links[i];
          if (!isInternal(link.href)) {
            // undo the damage that might have been done by quarto-nav.js in the case of
            // links that we want to consider external
            if (link.dataset.originalHref !== undefined) {
              link.href = link.dataset.originalHref;
            }
          }
        }
      function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
        const config = {
          allowHTML: true,
          maxWidth: 500,
          delay: 100,
          arrow: false,
          appendTo: function(el) {
              return el.closest('section.slide') || el.parentElement;
          },
          interactive: true,
          interactiveBorder: 10,
          theme: 'light-border',
          placement: 'bottom-start',
        };
        if (contentFn) {
          config.content = contentFn;
        }
        if (onTriggerFn) {
          config.onTrigger = onTriggerFn;
        }
        if (onUntriggerFn) {
          config.onUntrigger = onUntriggerFn;
        }
          config['offset'] = [0,0];
          config['maxWidth'] = 700;
        window.tippy(el, config); 
      }
      const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
      for (var i=0; i<noterefs.length; i++) {
        const ref = noterefs[i];
        tippyHover(ref, function() {
          // use id or data attribute instead here
          let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
          try { href = new URL(href).hash; } catch {}
          const id = href.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note) {
            return note.innerHTML;
          } else {
            return "";
          }
        });
      }
      const findCites = (el) => {
        const parentEl = el.parentElement;
        if (parentEl) {
          const cites = parentEl.dataset.cites;
          if (cites) {
            return {
              el,
              cites: cites.split(' ')
            };
          } else {
            return findCites(el.parentElement)
          }
        } else {
          return undefined;
        }
      };
      var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
      for (var i=0; i<bibliorefs.length; i++) {
        const ref = bibliorefs[i];
        const citeInfo = findCites(ref);
        if (citeInfo) {
          tippyHover(citeInfo.el, function() {
            var popup = window.document.createElement('div');
            citeInfo.cites.forEach(function(cite) {
              var citeDiv = window.document.createElement('div');
              citeDiv.classList.add('hanging-indent');
              citeDiv.classList.add('csl-entry');
              var biblioDiv = window.document.getElementById('ref-' + cite);
              if (biblioDiv) {
                citeDiv.innerHTML = biblioDiv.innerHTML;
              }
              popup.appendChild(citeDiv);
            });
            return popup.innerHTML;
          });
        }
      }
    });
    </script>
    

</body></html>